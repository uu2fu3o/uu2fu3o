import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as s,o as n}from"./app-DS0ZCcmM.js";const t={};function p(l,i){return n(),a("div",null,i[0]||(i[0]=[s(`<h1 id="exchange攻击手法" tabindex="-1"><a class="header-anchor" href="#exchange攻击手法"><span>Exchange攻击手法</span></a></h1><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言"><span>前言</span></a></h2><p>大概复现一些常见的exchange攻击手法，从定位，无用户攻击，低权限和高权限来分别讨论</p><h2 id="定位" tabindex="-1"><a class="header-anchor" href="#定位"><span>定位</span></a></h2><h3 id="在外网搜索exchange" tabindex="-1"><a class="header-anchor" href="#在外网搜索exchange"><span>在外网搜索Exchange</span></a></h3><p>通过fofa进行搜索,给出一个大致的格式</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>app=&quot;Microsoft-Exchange-2016&quot;</span></span>
<span class="line"><span>app=&quot;Microsoft-Exchange-2016-CU5&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果要定位到特定的版本，修改2016和CU5的位置即可</p><h3 id="如何在域内快速定位到exchange" tabindex="-1"><a class="header-anchor" href="#如何在域内快速定位到exchange"><span>如何在域内快速定位到Exchange</span></a></h3><p><strong>端口探测</strong></p><p>Exchange的端口一些特征，通过nmap扫描可以看出exchange 接口会暴露在80端口，同时25/587/2525等端口上会有SMTP服务</p><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205214217694.png" alt="image-20231205214217694" tabindex="0" loading="lazy"><figcaption>image-20231205214217694</figcaption></figure><p><strong>SPN</strong></p><p>查询域内的SPN</p><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205220031699.png" alt="image-20231205220031699" tabindex="0" loading="lazy"><figcaption>image-20231205220031699</figcaption></figure><p><strong>特殊域名</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>https://autodiscover.domain.com/autodiscover/autodiscover.xml</span></span>
<span class="line"><span>https://owa.domian/owa/</span></span>
<span class="line"><span>https://mail.domain.com/</span></span>
<span class="line"><span>https://webmail.domain.com/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>使用工具</strong></p><p><a href="https://github.com/vysec/checkO365" target="_blank" rel="noopener noreferrer">https://github.com/vysec/checkO365</a></p><p><strong>确定版本</strong></p><p>确定好exchange页面的位置之后，访问owa和ecp从html来确定当前站点exchange的版本</p><p>从开发者页面搜索favicon.ico</p><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205224000491.png" alt="image-20231205224000491" tabindex="0" loading="lazy"><figcaption>image-20231205224000491</figcaption></figure><p>有具体的版本号，根据该版本号进行查询</p><p><a href="https://learn.microsoft.com/zh-cn/Exchange/new-features/build-numbers-and-release-dates?view=exchserver-2019" target="_blank" rel="noopener noreferrer">microsoft</a></p><p><strong>IP泄露</strong></p><p>抓包以下接口包，将HTTP版本改为1.0，并删除HOST头，就会暴露exchange ip，有时会暴露内网IP</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/Microsoft-Server-ActiveSync/default.eas</span></span>
<span class="line"><span>/Microsoft-Server-ActiveSync</span></span>
<span class="line"><span>/Autodiscover/Autodiscover.xml</span></span>
<span class="line"><span>/Autodiscover</span></span>
<span class="line"><span>/Exchange</span></span>
<span class="line"><span>/Rpc</span></span>
<span class="line"><span>/EWS/Exchange.asmx</span></span>
<span class="line"><span>/EWS/Services.wsdl</span></span>
<span class="line"><span>/EWS</span></span>
<span class="line"><span>/ecp</span></span>
<span class="line"><span>/OAB</span></span>
<span class="line"><span>/OWA</span></span>
<span class="line"><span>/aspnet_client</span></span>
<span class="line"><span>/PowerShell</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于在内网的 exchange不太实用，对于外网会比较实用一些，这里出去打野测试了一下</p><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/123.png" alt="123" tabindex="0" loading="lazy"><figcaption>123</figcaption></figure><p>不过在打野途中也遇到了无法返回IP的情况，目前猜测是因为server2019的原因，不过这里也没有返回具体的版本</p><p><strong>泄露exchange服务器信息</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>nmap host  -p 443 --script http-ntlm-info --script-args http-ntlm-info.root=/rpc/rpcproxy.dll -Pn</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231206160623999.png" alt="image-20231206160623999" tabindex="0" loading="lazy"><figcaption>image-20231206160623999</figcaption></figure><p>这个扫描在域外也可以进行，能够返回exchange服务器的信息以及域的部分信息</p><h2 id="无用户攻击" tabindex="-1"><a class="header-anchor" href="#无用户攻击"><span>无用户攻击</span></a></h2><p>即外围打点的操作，核心思想是获得邮箱用户进行深度攻击</p><p><strong>爆破</strong></p><p>Exchange服务有几个比较重要的接口比如owa,ecp，以及一些可以用来爆破的接口</p><p>常见可爆破接口</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/Autodiscover/Autodiscover.xml  # 自 Exchange Server 2007 开始推出的一项自动服务,用于自动配置用户在Outlook中邮箱的相关设置,简化用户登录使用邮箱的流程。</span></span>
<span class="line"><span>/Microsoft-Server-ActiveSync/default.eas</span></span>
<span class="line"><span>/Microsoft-Server-ActiveSync    # 用于移动应用程序访问电子邮件</span></span>
<span class="line"><span>/Autodiscover</span></span>
<span class="line"><span>/Rpc/                           # 早期的 Outlook 还使用称为 Outlook Anywhere 的 RPC 交互</span></span>
<span class="line"><span>/EWS/Exchange.asmx</span></span>
<span class="line"><span>/EWS/Services.wsdl</span></span>
<span class="line"><span>/EWS/                           # Exchange Web Service,实现客户端与服务端之间基于HTTP的SOAP交互</span></span>
<span class="line"><span>/OAB/                           # 用于为Outlook客户端提供地址簿的副本,减轻 Exchange 的负担</span></span>
<span class="line"><span>/owa                            # Exchange owa 接口,用于通过web应用程序访问邮件、日历、任务和联系人等</span></span>
<span class="line"><span>/ecp                            # Exchange 管理中心,管理员用于管理组织中的Exchange 的Web控制台</span></span>
<span class="line"><span>/Mapi                           # Outlook连接 Exchange 的默认方式,在2013和2013之后开始使用,2010 sp2同样支持</span></span>
<span class="line"><span>/powershell                     # 用于服务器管理的 Exchange 管理控制台</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231206164253327.png" alt="image-20231206164253327" tabindex="0" loading="lazy"><figcaption>image-20231206164253327</figcaption></figure><p><a href="https://github.com/sensepost/ruler/releases/tag/2.4.1" target="_blank" rel="noopener noreferrer">RULER</a></p><p><strong>密码喷洒</strong></p><p><a href="https://github.com/dafthack/MailSniper" target="_blank" rel="noopener noreferrer">MailSniper</a></p><div class="language-powershell line-numbers-mode" data-highlighter="shiki" data-ext="powershell" data-title="powershell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">对OWA进行爆破</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Import-Module</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> .\\MailSniper.ps1Invoke</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">PasswordSprayOWA </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExchHostname OWAHOST </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">UserList .\\user.txt </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Password password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Threads </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Domain domainname </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">OutFile out.txt </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Verbose </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">对EWS进行爆破</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Invoke-PasswordSprayEWS</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExchHostname EWSHOST </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">UserList .\\user.txt </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Password password </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Threads </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Domain domainname </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">OutFile out.txt </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Verbose</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CVE-2021-26855+CVE-2021-27065</strong></p><p>CVE-2021-26855是一个SSRF漏洞，可以在无用户的情况下绕过Exchange的身份验证</p><p>CVE-2021-27065是一个任意文件写入漏洞，这个漏洞要求一个邮件服务器的账户，而ssrf正好提供了这一点</p><p>两个漏洞结合，能够达到getshell的目的</p><ul><li><p>漏洞影响版本</p><p>Exchange Server 2019 &lt; 15.02.0792.010</p><p>Exchange Server 2019 &lt; 15.02.0721.013</p><p>Exchange Server 2016 &lt; 15.01.2106.013</p><p>Exchange Server 2013 &lt; 15.00.1497.012</p></li></ul><p>可以适用一键式的脚本直接getshell</p><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231206220234713.png" alt="image-20231206220234713" tabindex="0" loading="lazy"><figcaption>image-20231206220234713</figcaption></figure><p><a href="https://github.com/ZephrFish/Exch-CVE-2021-26855" target="_blank" rel="noopener noreferrer">tools</a></p><h2 id="exchange后渗透" tabindex="-1"><a class="header-anchor" href="#exchange后渗透"><span>Exchange后渗透</span></a></h2><p>获取用户一个用户之后，可以对邮件列表进行检索获取敏感信息，方便下一步渗透</p><p>MailSniper</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#检索hacker@loser.com收件箱文件夹里内容含有 pass,在启用remote参数后会弹出一个输入框输入邮箱票据</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Invoke-SelfSearch</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Mailbox</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hacker@loser.com</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Terms</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">pass</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Folder</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 收件箱</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -ExchangeVersion</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Exchange2016</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -remote</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -OutputCsv</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> out.csv</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211105904411.png" alt="image-20231211105904411" tabindex="0" loading="lazy"><figcaption>image-20231211105904411</figcaption></figure><p><strong>获取全局地址列表</strong></p><p>我们获得一个合法用户的凭据以后，就可以通过获取全局地址表来获取所有邮箱地址</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Get-GlobalAddressList -ExchHostname 192.168.30.88 -UserName hacker -ExchangeVersion Exchange2016 -Password UU2FU3O@ADMIN</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211160117124.png" alt="image-20231211160117124" tabindex="0" loading="lazy"><figcaption>image-20231211160117124</figcaption></figure><p><strong>查找存在缺陷的用户邮箱权限委派</strong></p><p>一个用户的邮箱是可以被委托给其他人的</p><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211195057394.png" alt="image-20231211195057394" tabindex="0" loading="lazy"><figcaption>image-20231211195057394</figcaption></figure><p>这里将loser用户的邮箱委派给其他所有人，通常情况下A对B的邮箱有读写权限，如果我们有A的凭据就可以检索B的邮箱</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>Invoke-OpenInboxFinder -ExchangeVersion Exchange2016 -ExchHostname 192.168.30.88 -Mailbox loser@loser.com -remote</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><figure><img src="https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211195635879.png" alt="image-20231211195635879" tabindex="0" loading="lazy"><figcaption>image-20231211195635879</figcaption></figure><p><strong>通过Exchange用户组进行域提权</strong></p><p>概括来讲就是利用WriteDacl，exchange windows permissions组的用户拥有writeDACL权限，Exchange Trusted Subsystem 是 Exchange Windows Permission 的成员，能继承writedacl权限，有这个权限后就能使用dcsync导出所有用户hash。</p><p>同样拥有此权限的还有Organization Management组，这个组可以修改其他exchange组的用户信息，所以当然也可以修改Exchange Trusted Subsystem组的成员信息，比如向里面加一个以获得的用户。</p><p><strong>攻击outlook客户端</strong></p><p>OUTLOOK 客户端有一个 规则与通知 的功能，通过该功能可以使outlook客户端在指定情况下执行指定的指令。若我们获得某用户的凭证，可以通过此功能设置“用户收到含指定字符的邮件时 执行指定的指令比如clac.exe”，当用户登录outlook客户端并访问到此邮件时，它的电脑便会执行calc.exe。<br> 但是，当触发动作为启动应用程序时，只能直接调用可执行程序，如启动一个exe程序，但无法为应用程序传递参数，想要直接上线，我们可以将EXE放到某共享目录下，或者直接上传到用户的机器。</p><h2 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接"><span>参考链接</span></a></h2><p><a href="https://tttang.com/archive/1487/#toc_exchange_1" target="_blank" rel="noopener noreferrer">https://tttang.com/archive/1487/#toc_exchange_1</a></p><p><a href="https://rain1-lce.gitbook.io/web/windowsad-ji-chu/exchange-pian" target="_blank" rel="noopener noreferrer">https://rain1-lce.gitbook.io/web/windowsad-ji-chu/exchange-pian</a></p><p><a href="https://3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E4%BD%BF%E7%94%A8Exchange%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E7%89%B9%E5%AE%9A%E7%9A%84ACL%E5%AE%9E%E7%8E%B0%E5%9F%9F%E6%8F%90%E6%9D%83" target="_blank" rel="noopener noreferrer">https://3gstudent.github.io/域渗透-使用Exchange服务器中特定的ACL实现域提权</a></p>`,78)]))}const c=e(t,[["render",p],["__file","exchane攻击手法.html.vue"]]),o=JSON.parse('{"path":"/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/Exchange%E4%B8%93%E9%A2%98/exchane%E6%94%BB%E5%87%BB%E6%89%8B%E6%B3%95.html","title":"Exchange攻击手法","lang":"zh-CN","frontmatter":{"description":"Exchange攻击手法 前言 大概复现一些常见的exchange攻击手法，从定位，无用户攻击，低权限和高权限来分别讨论 定位 在外网搜索Exchange 通过fofa进行搜索,给出一个大致的格式 如果要定位到特定的版本，修改2016和CU5的位置即可 如何在域内快速定位到Exchange 端口探测 Exchange的端口一些特征，通过nmap扫描可以...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/Exchange%E4%B8%93%E9%A2%98/exchane%E6%94%BB%E5%87%BB%E6%89%8B%E6%B3%95.html"}],["meta",{"property":"og:site_name","content":"uu2fu3o的知识库"}],["meta",{"property":"og:title","content":"Exchange攻击手法"}],["meta",{"property":"og:description","content":"Exchange攻击手法 前言 大概复现一些常见的exchange攻击手法，从定位，无用户攻击，低权限和高权限来分别讨论 定位 在外网搜索Exchange 通过fofa进行搜索,给出一个大致的格式 如果要定位到特定的版本，修改2016和CU5的位置即可 如何在域内快速定位到Exchange 端口探测 Exchange的端口一些特征，通过nmap扫描可以..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205214217694.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-15T18:41:02.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-15T18:41:02.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Exchange攻击手法\\",\\"image\\":[\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205214217694.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205220031699.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231205224000491.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/123.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231206160623999.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231206164253327.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231206220234713.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211105904411.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211160117124.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211195057394.png\\",\\"https://raw.githubusercontent.com/uu2fu3o/blog-picture/main/ldapp/image-20231211195635879.png\\"],\\"dateModified\\":\\"2025-01-15T18:41:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"uu2fu3o\\",\\"url\\":\\"https://mister-hope.com\\"}]}"]]},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"定位","slug":"定位","link":"#定位","children":[{"level":3,"title":"在外网搜索Exchange","slug":"在外网搜索exchange","link":"#在外网搜索exchange","children":[]},{"level":3,"title":"如何在域内快速定位到Exchange","slug":"如何在域内快速定位到exchange","link":"#如何在域内快速定位到exchange","children":[]}]},{"level":2,"title":"无用户攻击","slug":"无用户攻击","link":"#无用户攻击","children":[]},{"level":2,"title":"Exchange后渗透","slug":"exchange后渗透","link":"#exchange后渗透","children":[]},{"level":2,"title":"参考链接","slug":"参考链接","link":"#参考链接","children":[]}],"git":{"createdTime":1736966462000,"updatedTime":1736966462000,"contributors":[{"name":"uu2fu3o","username":"uu2fu3o","email":"1027578439@qq.com","commits":1,"url":"https://github.com/uu2fu3o"}]},"readingTime":{"minutes":5.31,"words":1594},"filePathRelative":"渗透测试/Exchange专题/exchane攻击手法.md","localizedDate":"2025年1月16日","excerpt":"\\n<h2>前言</h2>\\n<p>大概复现一些常见的exchange攻击手法，从定位，无用户攻击，低权限和高权限来分别讨论</p>\\n<h2>定位</h2>\\n<h3>在外网搜索Exchange</h3>\\n<p>通过fofa进行搜索,给出一个大致的格式</p>\\n<div class=\\"language- line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"\\" data-title=\\"\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>app=\\"Microsoft-Exchange-2016\\"</span></span>\\n<span class=\\"line\\"><span>app=\\"Microsoft-Exchange-2016-CU5\\"</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{c as comp,o as data};
